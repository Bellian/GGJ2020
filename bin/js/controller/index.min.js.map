{"version":3,"sources":["index.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","Object","defineProperty","value","index_1","Client","prototype","currentPlayerData","_this","this","playerData","filter","pD","id","getPlayers","setInterval","airconsole","getControllerDeviceIds","getObjectData","objectData","sendControllerData","controllerData","notifyServer","recive","subscribeToAirConsole","onMessage","from","data","transactionType","TransactionType","PlayerData","ObjectData","ServerData","serverData","console","error","toggleAngryDad","currentPlayer","undefined","isAngryDad","changeAppearance","appearance","characterAppearanceType","message","AirConsole","SCREEN","JSON","stringify","serverState","ServerState","joining","getDeviceId","getPlayerData","./index","2","__export","m","hasOwnProperty","x","y","deviceId","playerState","PlayerState","idle","CharacterAppearanceType","wichtel1","ControllerData","timerValueInSeconds","./client","./server","3","Server","createAndUpdatePlayer","playerFound","find","push","startAfterFirstPlayerJoined","updatePlayer","lobby","updateServerState","serverStateUpdate","characterSelection","running","final","cb","setAndStartTimer","setTimeout","updateData","sendPlayerData","sendAllClients","sendObjectData","sendServerData","airConsole","broadcast","initial","4","Views","Controller","client","startPos","document","addEventListener","virtualController","updateView","showView","view","querySelectorAll","classList","add","hideView","remove","splashscreen","characterselection","playscreen","endscreen","ev","log","targetTouches","clientX","clientY","forEach","btn","character","isPlayerAngryDad","innerHTML","timeUntilStartInterval","timeUntilStart","getTimeUntilStart","clearInterval","../common/index"],"mappings":"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","file":"index.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar index_1 = require(\"./index\");\nvar Client = /** @class */ (function () {\n    function Client() {\n        this.serverState = index_1.ServerState.joining;\n        this.id = 0;\n        if (!this.id)\n            this.id = this.airconsole.getDeviceId();\n        this.airconsole = new AirConsole();\n        this.subscribeToAirConsole();\n        this.playerData = this.airconsole.getPlayerData();\n        this.getPlayers();\n    }\n    Client.prototype.currentPlayerData = function () {\n        var _this = this;\n        return this.playerData.filter(function (pD) { return pD.id === _this.id; })[0];\n    };\n    Client.prototype.getPlayers = function () {\n        var _this = this;\n        setInterval(function () {\n            (_this.playerData = _this.airconsole.getControllerDeviceIds), 300;\n        });\n    };\n    Client.prototype.getObjectData = function () {\n        var _this = this;\n        setInterval(function () {\n            (_this.objectData = _this.airconsole.getControllerDeviceIds), 300;\n        });\n    };\n    Client.prototype.sendControllerData = function (controllerData) {\n        controllerData.id = this.id;\n        this.notifyServer(controllerData);\n    };\n    Client.prototype.recive = function () {\n        this.playerData;\n    };\n    Client.prototype.subscribeToAirConsole = function () {\n        this.onMessage();\n    };\n    Client.prototype.onMessage = function () {\n        var _this = this;\n        this.airconsole.onMessage = function (from, data) {\n            switch (data.transactionType) {\n                case index_1.TransactionType.PlayerData:\n                    _this.playerData = data.playerData;\n                    break;\n                case index_1.TransactionType.ObjectData:\n                    _this.objectData = data.objectData;\n                    break;\n                case index_1.TransactionType.ServerData:\n                    _this.serverData = data.serverData;\n                    break;\n                default:\n                    console.error(\"not implemented\", data);\n                    break;\n            }\n        };\n    };\n    Client.prototype.toggleAngryDad = function () {\n        var currentPlayer = this.currentPlayerData();\n        if (currentPlayer.isAngryDad === undefined) {\n            currentPlayer.isAngryDad = false;\n        }\n        else {\n            currentPlayer.isAngryDad = !currentPlayer.isAngryDad;\n        }\n        this.notifyServer(currentPlayer);\n        return currentPlayer.isAngryDad;\n    };\n    Client.prototype.changeAppearance = function (appearance) {\n        var currentPlayer = this.currentPlayerData();\n        currentPlayer.characterAppearanceType = appearance;\n        this.notifyServer(currentPlayer);\n        return currentPlayer.characterAppearanceType;\n    };\n    Client.prototype.notifyServer = function (data) {\n        this.airconsole.message(AirConsole.SCREEN, JSON.stringify(data));\n    };\n    return Client;\n}());\nexports.Client = Client;\n\n\n\n},{\"./index\":2}],2:[function(require,module,exports){\n\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./client\"));\n__export(require(\"./server\"));\nvar PlayerData = /** @class */ (function () {\n    function PlayerData(x, y, deviceId) {\n        this.x = x;\n        this.y = y;\n        this.transactionType = TransactionType.PlayerData;\n        this.playerState = PlayerState.idle;\n        this.characterAppearanceType = CharacterAppearanceType.wichtel1;\n        this.isAngryDad = undefined;\n        this.id = 0;\n        this.id = deviceId;\n    }\n    return PlayerData;\n}());\nexports.PlayerData = PlayerData;\nvar TransactionType;\n(function (TransactionType) {\n    TransactionType[TransactionType[\"ServerData\"] = 0] = \"ServerData\";\n    TransactionType[TransactionType[\"PlayerData\"] = 1] = \"PlayerData\";\n    TransactionType[TransactionType[\"ControllerData\"] = 2] = \"ControllerData\";\n    TransactionType[TransactionType[\"ObjectData\"] = 3] = \"ObjectData\";\n})(TransactionType = exports.TransactionType || (exports.TransactionType = {}));\nvar ServerState;\n(function (ServerState) {\n    ServerState[ServerState[\"initial\"] = 0] = \"initial\";\n    ServerState[ServerState[\"lobby\"] = 1] = \"lobby\";\n    ServerState[ServerState[\"characterSelection\"] = 2] = \"characterSelection\";\n    ServerState[ServerState[\"running\"] = 3] = \"running\";\n    ServerState[ServerState[\"final\"] = 4] = \"final\";\n})(ServerState = exports.ServerState || (exports.ServerState = {}));\nvar ControllerData = /** @class */ (function () {\n    function ControllerData(x, y) {\n        if (x === void 0) { x = 0; }\n        if (y === void 0) { y = 0; }\n        this.x = x;\n        this.y = y;\n        this.transactionType = TransactionType.ControllerData;\n        this.id = 0;\n    }\n    return ControllerData;\n}());\nexports.ControllerData = ControllerData;\nvar ServerData = /** @class */ (function () {\n    function ServerData(timerValueInSeconds) {\n        this.timerValueInSeconds = timerValueInSeconds;\n    }\n    return ServerData;\n}());\nexports.ServerData = ServerData;\nvar PlayerState;\n(function (PlayerState) {\n    PlayerState[PlayerState[\"idle\"] = 0] = \"idle\";\n    PlayerState[PlayerState[\"dead\"] = 1] = \"dead\";\n    PlayerState[PlayerState[\"running\"] = 2] = \"running\";\n    PlayerState[PlayerState[\"interacting\"] = 3] = \"interacting\";\n})(PlayerState = exports.PlayerState || (exports.PlayerState = {}));\nvar CharacterAppearanceType;\n(function (CharacterAppearanceType) {\n    CharacterAppearanceType[CharacterAppearanceType[\"wichtel1\"] = 0] = \"wichtel1\";\n    CharacterAppearanceType[CharacterAppearanceType[\"wichtel2\"] = 1] = \"wichtel2\";\n    CharacterAppearanceType[CharacterAppearanceType[\"wichtel3\"] = 2] = \"wichtel3\";\n    CharacterAppearanceType[CharacterAppearanceType[\"wichtel4\"] = 3] = \"wichtel4\";\n})(CharacterAppearanceType = exports.CharacterAppearanceType || (exports.CharacterAppearanceType = {}));\nvar ObjectData = /** @class */ (function () {\n    function ObjectData(x, y, id) {\n        if (x === void 0) { x = 0; }\n        if (y === void 0) { y = 0; }\n        this.x = x;\n        this.y = y;\n        this.id = id;\n    }\n    return ObjectData;\n}());\nexports.ObjectData = ObjectData;\n\n\n\n},{\"./client\":1,\"./server\":3}],3:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar index_1 = require(\"./index\");\nvar Server = /** @class */ (function () {\n    function Server() {\n        var _this = this;\n        this.serverState = index_1.ServerState.initial;\n        this.timerValueInSeconds = 0;\n        this.airConsole = new AirConsole();\n        this.playerData = [];\n        this.objectData = [];\n        this.updateServerState = function () { return function (cb) {\n            cb(_this.serverState);\n        }; };\n    }\n    Server.prototype.createAndUpdatePlayer = function (data) {\n        var playerFound = this.playerData.find(function (pD) { return pD.id === data.id; });\n        if (!playerFound) {\n            playerFound = new index_1.PlayerData(0, 0, data.id, false);\n            this.playerData.push(playerFound);\n            this.startAfterFirstPlayerJoined();\n        }\n        this.updatePlayer(data);\n    };\n    Server.prototype.startAfterFirstPlayerJoined = function () {\n        var _this = this;\n        if (this.playerData.length == 1) {\n            this.serverState = index_1.ServerState.lobby;\n            this.updateServerState();\n            this.serverStateUpdate(30, index_1.ServerState.characterSelection, function () {\n                _this.serverStateUpdate(15, index_1.ServerState.running, function () {\n                    _this.serverStateUpdate(300, index_1.ServerState.final, function () { });\n                });\n            });\n        }\n    };\n    Server.prototype.serverStateUpdate = function (timerValueInSeconds, serverState, cb) {\n        var _this = this;\n        this.setAndStartTimer(timerValueInSeconds);\n        setTimeout(function () {\n            _this.serverState = serverState;\n            _this.updateServerState();\n            cb();\n        }, timerValueInSeconds);\n    };\n    Server.prototype.setAndStartTimer = function (timerValueInSeconds) {\n        var _this = this;\n        this.timerValueInSeconds = timerValueInSeconds;\n        setInterval(function () {\n            if (_this.timerValueInSeconds)\n                _this.timerValueInSeconds--;\n        }, 1000);\n    };\n    Server.prototype.updatePlayer = function (updateData) {\n        var player = this.playerData.filter(function (pD) { return pD.id === updateData.id; })[0];\n        player = player;\n        this.sendPlayerData();\n    };\n    Server.prototype.sendPlayerData = function () {\n        this.sendAllClients({\n            transactionType: index_1.TransactionType.PlayerData,\n            playerData: this.playerData\n        });\n    };\n    Server.prototype.sendObjectData = function () {\n        this.sendAllClients({\n            transactionType: index_1.TransactionType.ObjectData,\n            objectData: this.objectData\n        });\n    };\n    Server.prototype.sendServerData = function () {\n        this.sendAllClients({\n            transactionType: index_1.TransactionType.ServerData,\n            serverData: new index_1.ServerData(this.timerValueInSeconds)\n        });\n    };\n    Server.prototype.sendAllClients = function (data) {\n        this.airConsole.broadcast(data);\n    };\n    Server.prototype.onMessage = function () {\n        var _this = this;\n        this.airconsole.onMessage = function (from, data) {\n            switch (data.transactionType) {\n                case index_1.TransactionType.PlayerData:\n                    _this.createAndUpdatePlayer(data);\n                    break;\n                case index_1.TransactionType.ControllerData:\n                    var controllerData = data;\n                    // let currentPlayerData = this.getOrCreatePlayer(data);\n                    // ///TODO: calculate player position\n                    _this.updatePlayer(data);\n                    break;\n                default:\n                    console.error(\"not implemented\", data);\n                    break;\n            }\n            _this.sendPlayerData();\n        };\n    };\n    return Server;\n}());\nexports.Server = Server;\n\n\n\n},{\"./index\":2}],4:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar index_1 = require(\"../common/index\");\nvar Views;\n(function (Views) {\n    Views[Views[\"splashscreen\"] = 0] = \"splashscreen\";\n    Views[Views[\"characterselection\"] = 1] = \"characterselection\";\n    Views[Views[\"playscreen\"] = 2] = \"playscreen\";\n    Views[Views[\"endscreen\"] = 3] = \"endscreen\";\n})(Views || (Views = {}));\nvar Controller = /** @class */ (function () {\n    function Controller(client) {\n        var _this = this;\n        this.client = client;\n        this.startPos = undefined;\n        document.addEventListener('DOMContentLoaded', function () {\n            _this.virtualController();\n            _this.client.updateServerState(_this.updateView);\n        });\n    }\n    Controller.prototype.showView = function (view) {\n        document.querySelectorAll(Views[view])[0].classList.add('visible');\n    };\n    Controller.prototype.hideView = function (view) {\n        document.querySelectorAll(Views[view])[0].classList.remove('visible');\n    };\n    Controller.prototype.updateView = function (serverState) {\n        switch (serverState) {\n            case index_1.ServerState.lobby:\n                this.showView(Views.splashscreen);\n                break;\n            case index_1.ServerState.characterSelection:\n                this.showView(Views.characterselection);\n                break;\n            case index_1.ServerState.running:\n                this.showView(Views.playscreen);\n                break;\n            case index_1.ServerState.final:\n                this.showView(Views.endscreen);\n                break;\n            default:\n                console.error('not implemented', serverState);\n        }\n    };\n    Controller.prototype.virtualController = function () {\n        var _this = this;\n        document.querySelectorAll('controller')[0].addEventListener('touchstart', function (ev) {\n            console.log('touchstart');\n            _this.startPos = [ev.targetTouches[0].clientX, ev.targetTouches[0].clientY];\n        });\n        document.querySelectorAll('controller')[0].addEventListener('touchmove', function (ev) {\n            if (_this.startPos !== undefined) {\n                _this.client.sendControllerData(new index_1.ControllerData(ev.targetTouches[0].clientX - _this.startPos[0], ev.targetTouches[0].clientY - _this.startPos[1]));\n            }\n        });\n        document.querySelectorAll('controller')[0].addEventListener('touchend', function (ev) {\n            _this.startPos = undefined;\n        });\n    };\n    Controller.prototype.splashscreen = function () {\n        var _this = this;\n        document.querySelectorAll('splashscreen > button').forEach(function (btn) {\n            var character = document.querySelectorAll('splashscreen > character')[0];\n            var isPlayerAngryDad = _this.client.toggleAngryDad();\n            if (isPlayerAngryDad) {\n                character.innerHTML = 'You would like to be angry dad!';\n            }\n            else {\n                character.innerHTML = 'You would like to be a wichtel!';\n            }\n        });\n        var timeUntilStartInterval = setInterval(function () {\n            var timeUntilStart = _this.client.getTimeUntilStart();\n            document.querySelectorAll('splashscreen > time')[0].innerHTML = timeUntilStart;\n            if (timeUntilStart === 0) {\n                clearInterval(timeUntilStartInterval);\n            }\n        }, 1000);\n    };\n    return Controller;\n}());\nvar client = new index_1.Client();\nnew Controller(client);\n\n\n\n},{\"../common/index\":2}]},{},[4]);\n\n//# sourceMappingURL=index.js.map\n"]}