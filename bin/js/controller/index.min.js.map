{"version":3,"sources":["index.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","Object","defineProperty","value","index_1","Client","prototype","onAirConReady","this","airConsole","AirConsole","id","getDeviceId","subscribeToAirConsole","onUpdateServerData","cb","updateServerCallbacks","add","updateServerData","_this","forEach","serverData","currentPlayerData","playerData","filter","pD","sendControllerData","controllerData","notifyServer","onMessage","from","data","transactionType","TransactionType","PlayerData","ObjectData","objectData","ServerData","console","error","toggleAngryDad","currentPlayer","undefined","isAngryDad","changeAppearance","appearance","characterAppearanceType","interacting","playerState","message","SCREEN","JSON","stringify","getTime","timerValueInSeconds","Set","onReady","./index","2","__export","m","hasOwnProperty","x","y","deviceId","PlayerState","idle","CharacterAppearanceType","wichtel1","ServerState","ControllerData","serverState","initial","damage","objectId","./client","./server","3","OBJECTDATAMAXHEALTH","Server","onUpdateServerState","updateControllerCallbacks","updateServerState","onUpdateControllerData","updateControllerData","createAndUpdatePlayer","playerFound","find","updatePlayer","push","sendPlayerData","startAfterFirstPlayerJoined","lobby","serverStateUpdate","characterSelection","running","final","timer","setAndStartTimer","setTimeout","clearInterval","setInterval","sendServerData","updateData","player","playerIndex","indexOf","itemFound","sendAllClients","broadcast","onConnect","sendObjectData","4","Views","Controller","showView","view","document","querySelectorAll","classList","hideView","remove","updateView","splashscreen","characterselection","playscreen","virtualController","endscreen","addEventListener","ev","startPos","targetTouches","clientX","clientY","client","setTime","btn","log","timeUntilInterval","timeUntil","innerHTML","toString","bind","controller","test","../common/index"],"mappings":"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","file":"index.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar index_1 = require(\"./index\");\nvar Client = /** @class */ (function () {\n    function Client() {\n        this.id = 0;\n        this.playerData = [];\n        this.objectData = [];\n        this.updateServerCallbacks = new Set();\n        this.serverData = new index_1.ServerData();\n        this.airConsole.onReady(this.onAirConReady);\n    }\n    Client.prototype.onAirConReady = function () {\n        this.airConsole = new AirConsole();\n        if (!this.id)\n            this.id = this.airConsole.getDeviceId();\n        this.subscribeToAirConsole();\n    };\n    Client.prototype.onUpdateServerData = function (cb) {\n        this.updateServerCallbacks.add(cb);\n    };\n    Client.prototype.updateServerData = function () {\n        var _this = this;\n        this.updateServerCallbacks.forEach(function (e) { return e(_this.serverData); });\n    };\n    Client.prototype.currentPlayerData = function () {\n        var _this = this;\n        return this.playerData.filter(function (pD) { return pD.id === _this.id; })[0];\n    };\n    Client.prototype.sendControllerData = function (controllerData) {\n        controllerData.id = this.id;\n        this.notifyServer(controllerData);\n    };\n    Client.prototype.subscribeToAirConsole = function () {\n        var _this = this;\n        this.airConsole.onMessage = function (from, data) {\n            switch (data.transactionType) {\n                case index_1.TransactionType.PlayerData:\n                    _this.playerData = data.playerData;\n                    break;\n                case index_1.TransactionType.ObjectData:\n                    _this.objectData = data.objectData;\n                    break;\n                case index_1.TransactionType.ServerData:\n                    _this.serverData = data.serverData;\n                    _this.updateServerData();\n                    break;\n                default:\n                    console.error(\"not implemented\", data);\n                    break;\n            }\n        };\n    };\n    Client.prototype.toggleAngryDad = function () {\n        var currentPlayer = this.currentPlayerData();\n        if (currentPlayer.isAngryDad === undefined) {\n            currentPlayer.isAngryDad = false;\n        }\n        else {\n            currentPlayer.isAngryDad = !currentPlayer.isAngryDad;\n        }\n        this.notifyServer(currentPlayer);\n        return currentPlayer.isAngryDad;\n    };\n    Client.prototype.changeAppearance = function (appearance) {\n        var currentPlayer = this.currentPlayerData();\n        currentPlayer.characterAppearanceType = appearance;\n        this.notifyServer(currentPlayer);\n        return currentPlayer.characterAppearanceType;\n    };\n    Client.prototype.interacting = function (playerState) {\n        var currentPlayer = this.currentPlayerData();\n        currentPlayer.playerState = playerState;\n        this.notifyServer(currentPlayer);\n        return currentPlayer.playerState;\n    };\n    Client.prototype.notifyServer = function (data) {\n        this.airConsole.message(AirConsole.SCREEN, JSON.stringify(data));\n    };\n    Client.prototype.getTime = function () {\n        return this.serverData.timerValueInSeconds;\n    };\n    return Client;\n}());\nexports.Client = Client;\n\n\n\n},{\"./index\":2}],2:[function(require,module,exports){\n\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./client\"));\n__export(require(\"./server\"));\nvar PlayerData = /** @class */ (function () {\n    function PlayerData(x, y, deviceId) {\n        this.x = x;\n        this.y = y;\n        this.transactionType = TransactionType.PlayerData;\n        this.playerState = PlayerState.idle;\n        this.characterAppearanceType = CharacterAppearanceType.wichtel1;\n        this.isAngryDad = undefined;\n        this.id = 0;\n        this.id = deviceId;\n    }\n    return PlayerData;\n}());\nexports.PlayerData = PlayerData;\nvar TransactionType;\n(function (TransactionType) {\n    TransactionType[TransactionType[\"ServerData\"] = 0] = \"ServerData\";\n    TransactionType[TransactionType[\"PlayerData\"] = 1] = \"PlayerData\";\n    TransactionType[TransactionType[\"ControllerData\"] = 2] = \"ControllerData\";\n    TransactionType[TransactionType[\"ObjectData\"] = 3] = \"ObjectData\";\n})(TransactionType = exports.TransactionType || (exports.TransactionType = {}));\nvar ServerState;\n(function (ServerState) {\n    ServerState[ServerState[\"initial\"] = 0] = \"initial\";\n    ServerState[ServerState[\"lobby\"] = 1] = \"lobby\";\n    ServerState[ServerState[\"characterSelection\"] = 2] = \"characterSelection\";\n    ServerState[ServerState[\"running\"] = 3] = \"running\";\n    ServerState[ServerState[\"final\"] = 4] = \"final\";\n})(ServerState = exports.ServerState || (exports.ServerState = {}));\nvar ControllerData = /** @class */ (function () {\n    function ControllerData(x, y) {\n        if (x === void 0) { x = 0; }\n        if (y === void 0) { y = 0; }\n        this.x = x;\n        this.y = y;\n        this.transactionType = TransactionType.ControllerData;\n        this.id = 0;\n    }\n    return ControllerData;\n}());\nexports.ControllerData = ControllerData;\nvar ServerData = /** @class */ (function () {\n    function ServerData(timerValueInSeconds, serverState) {\n        if (timerValueInSeconds === void 0) { timerValueInSeconds = 30; }\n        if (serverState === void 0) { serverState = ServerState.initial; }\n        this.timerValueInSeconds = timerValueInSeconds;\n        this.serverState = serverState;\n    }\n    return ServerData;\n}());\nexports.ServerData = ServerData;\nvar PlayerState;\n(function (PlayerState) {\n    PlayerState[PlayerState[\"idle\"] = 0] = \"idle\";\n    PlayerState[PlayerState[\"dead\"] = 1] = \"dead\";\n    PlayerState[PlayerState[\"running\"] = 2] = \"running\";\n    PlayerState[PlayerState[\"interacting\"] = 3] = \"interacting\";\n})(PlayerState = exports.PlayerState || (exports.PlayerState = {}));\nvar CharacterAppearanceType;\n(function (CharacterAppearanceType) {\n    CharacterAppearanceType[CharacterAppearanceType[\"wichtel1\"] = 0] = \"wichtel1\";\n    CharacterAppearanceType[CharacterAppearanceType[\"wichtel2\"] = 1] = \"wichtel2\";\n    CharacterAppearanceType[CharacterAppearanceType[\"wichtel3\"] = 2] = \"wichtel3\";\n    CharacterAppearanceType[CharacterAppearanceType[\"wichtel4\"] = 3] = \"wichtel4\";\n})(CharacterAppearanceType = exports.CharacterAppearanceType || (exports.CharacterAppearanceType = {}));\nvar ObjectData = /** @class */ (function () {\n    function ObjectData(x, y, damage, objectId) {\n        if (x === void 0) { x = 0; }\n        if (y === void 0) { y = 0; }\n        if (damage === void 0) { damage = 0; }\n        this.x = x;\n        this.y = y;\n        this.damage = damage;\n        this.objectId = objectId;\n    }\n    return ObjectData;\n}());\nexports.ObjectData = ObjectData;\n\n\n\n},{\"./client\":1,\"./server\":3}],3:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar index_1 = require(\"./index\");\nexports.OBJECTDATAMAXHEALTH = 10;\nvar Server = /** @class */ (function () {\n    function Server() {\n        this.playerData = [];\n        this.objectData = [];\n        this.updateServerCallbacks = new Set();\n        this.updateControllerCallbacks = new Set();\n        this.airConsole = new AirConsole();\n        this.serverData = new index_1.ServerData();\n        this.subscribeToAirConsole();\n    }\n    Server.prototype.onUpdateServerState = function (cb) {\n        this.updateControllerCallbacks.add(cb);\n    };\n    Server.prototype.updateServerState = function () {\n        var _this = this;\n        this.updateServerCallbacks.forEach(function (e) { return e(_this.serverData.serverState); });\n    };\n    Server.prototype.onUpdateControllerData = function (cb) {\n        this.updateControllerCallbacks.add(cb);\n    };\n    Server.prototype.updateControllerData = function (controllerData) {\n        this.updateControllerCallbacks.forEach(function (e) { return e(controllerData); });\n    };\n    Server.prototype.createAndUpdatePlayer = function (data) {\n        var playerFound = this.playerData.find(function (pD) { return pD.id === data.id; });\n        if (!playerFound) {\n            playerFound = new index_1.PlayerData(0, 0, data.id);\n            this.playerData.push(playerFound);\n            this.sendPlayerData();\n            this.startAfterFirstPlayerJoined();\n        }\n        else {\n            this.updatePlayer(data);\n        }\n    };\n    Server.prototype.startAfterFirstPlayerJoined = function () {\n        var _this = this;\n        if (this.playerData.length == 1) {\n            this.serverData.serverState = index_1.ServerState.lobby;\n            this.updateServerState();\n            this.serverStateUpdate(30, index_1.ServerState.characterSelection, function () {\n                _this.serverStateUpdate(15, index_1.ServerState.running, function () {\n                    _this.serverStateUpdate(300, index_1.ServerState.final, function () { });\n                });\n            });\n        }\n    };\n    Server.prototype.serverStateUpdate = function (timerValueInSeconds, serverState, cb) {\n        var _this = this;\n        var timer = this.setAndStartTimer(timerValueInSeconds);\n        setTimeout(function () {\n            clearInterval(timer);\n            _this.serverData.serverState = serverState;\n            _this.updateServerState();\n            cb();\n        }, timerValueInSeconds * 1000);\n    };\n    Server.prototype.setAndStartTimer = function (timerValueInSeconds) {\n        var _this = this;\n        this.serverData.timerValueInSeconds = timerValueInSeconds;\n        return setInterval(function () {\n            if (_this.serverData.timerValueInSeconds)\n                _this.serverData.timerValueInSeconds--;\n            _this.sendServerData();\n        }, 1000);\n    };\n    Server.prototype.updatePlayer = function (updateData) {\n        var player = this.playerData.find(function (pD) { return pD.id === updateData.id; });\n        if (player) {\n            var playerIndex = this.playerData.indexOf(player);\n            this.playerData[playerIndex] = updateData;\n            if (updateData.playerState === index_1.PlayerState.interacting) {\n                //JS find Item and damage/heal\n                var itemFound = { damage: 0, x: 0, y: 0, objectId: 0 };\n                if (itemFound) {\n                    itemFound.damage += updateData.isAngryDad ? -1 : 1;\n                    if (itemFound.damage > exports.OBJECTDATAMAXHEALTH)\n                        itemFound.damage = exports.OBJECTDATAMAXHEALTH;\n                    if (itemFound.damage < 0)\n                        itemFound.damage = 0;\n                }\n                if (updateData.isAngryDad) {\n                    //check for wichtel\n                }\n            }\n            this.sendPlayerData();\n        }\n    };\n    Server.prototype.sendAllClients = function (data) {\n        this.airConsole.broadcast(data);\n    };\n    Server.prototype.onMessage = function () {\n        var _this = this;\n        this.airConsole.onMessage = function (from, data) {\n            switch (data.transactionType) {\n                case index_1.TransactionType.PlayerData:\n                    _this.createAndUpdatePlayer(data);\n                    break;\n                case index_1.TransactionType.ControllerData:\n                    _this.updateControllerData(data);\n                    //JS after change   this.updatePlayer()\n                    break;\n                default:\n                    console.error(\"not implemented\", data);\n                    break;\n            }\n            _this.sendPlayerData();\n        };\n    };\n    Server.prototype.subscribeToAirConsole = function () {\n        var _this = this;\n        this.onMessage();\n        this.airConsole.onConnect = function (id) {\n            _this.createAndUpdatePlayer({ id: id });\n            _this.sendObjectData();\n            _this.sendServerData();\n        };\n    };\n    Server.prototype.sendPlayerData = function () {\n        this.sendAllClients({\n            transactionType: index_1.TransactionType.PlayerData,\n            playerData: this.playerData\n        });\n    };\n    Server.prototype.sendObjectData = function () {\n        this.sendAllClients({\n            transactionType: index_1.TransactionType.ObjectData,\n            objectData: this.objectData\n        });\n    };\n    Server.prototype.sendServerData = function () {\n        this.sendAllClients({\n            transactionType: index_1.TransactionType.ServerData,\n            serverData: this.serverData\n        });\n    };\n    return Server;\n}());\nexports.Server = Server;\n\n\n\n},{\"./index\":2}],4:[function(require,module,exports){\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar index_1 = require(\"../common/index\");\nvar Views;\n(function (Views) {\n    Views[Views[\"splashscreen\"] = 0] = \"splashscreen\";\n    Views[Views[\"characterselection\"] = 1] = \"characterselection\";\n    Views[Views[\"playscreen\"] = 2] = \"playscreen\";\n    Views[Views[\"endscreen\"] = 3] = \"endscreen\";\n})(Views = exports.Views || (exports.Views = {}));\nvar Controller = /** @class */ (function () {\n    function Controller(client) {\n        this.client = client;\n        this.startPos = undefined;\n        this.client.onUpdateServerData(this.updateView.bind(this));\n    }\n    Controller.prototype.showView = function (view) {\n        document.querySelectorAll(Views[view])[0].classList.add('visible');\n    };\n    Controller.prototype.hideView = function (view) {\n        document.querySelectorAll(Views[view])[0].classList.remove('visible');\n    };\n    Controller.prototype.updateView = function (serverData) {\n        switch (serverData.serverState) {\n            case index_1.ServerState.lobby:\n                this.showView(Views.splashscreen);\n                this.lobby();\n                break;\n            case index_1.ServerState.characterSelection:\n                this.showView(Views.characterselection);\n                this.characterselection();\n                break;\n            case index_1.ServerState.running:\n                this.showView(Views.playscreen);\n                this.virtualController();\n                break;\n            case index_1.ServerState.final:\n                this.showView(Views.endscreen);\n                break;\n            default:\n                console.error('not implemented', serverData);\n        }\n    };\n    Controller.prototype.virtualController = function () {\n        var _this = this;\n        document.querySelectorAll('playscreen > controller')[0].addEventListener('touchstart', function (ev) {\n            _this.startPos = [ev.targetTouches[0].clientX, ev.targetTouches[0].clientY];\n        });\n        document.querySelectorAll('playscreen > controller')[0].addEventListener('touchmove', function (ev) {\n            if (_this.startPos !== undefined) {\n                _this.client.sendControllerData(new index_1.ControllerData(ev.targetTouches[0].clientX - _this.startPos[0], ev.targetTouches[0].clientY - _this.startPos[1]));\n            }\n        });\n        document.querySelectorAll('playscreen > controller')[0].addEventListener('touchend', function (ev) {\n            _this.startPos = undefined;\n        });\n    };\n    Controller.prototype.lobby = function () {\n        this.setTime(Views.splashscreen);\n    };\n    Controller.prototype.characterselection = function () {\n        var _this = this;\n        document.querySelectorAll('characterselection > button').forEach(function (btn) {\n            var isPlayerAngryDad = _this.client.toggleAngryDad();\n            if (isPlayerAngryDad) {\n                document.querySelectorAll('characterselection')[0].classList.add('isAngryDad');\n                console.log('You would like to be angry dad!');\n            }\n            else {\n                document.querySelectorAll('characterselection')[0].classList.remove('isAngryDad');\n                console.log('You would like to be a wichtel!');\n            }\n        });\n        this.setTime(Views.characterselection);\n    };\n    Controller.prototype.setTime = function (view) {\n        var _this = this;\n        var timeUntilInterval = setInterval(function () {\n            var timeUntil = _this.client.getTime();\n            document.querySelectorAll(Views[view] + ' > time')[0].innerHTML = timeUntil.toString();\n            if (timeUntil === 0) {\n                clearInterval(timeUntilInterval);\n            }\n        }, 1000);\n    };\n    return Controller;\n}());\ndocument.addEventListener('DOMContentLoaded', function () {\n    var client = new index_1.Client();\n    var controller = new Controller(client);\n    var test = new index_1.ServerData(30, index_1.ServerState.lobby);\n    controller.updateView(test);\n});\n\n\n\n},{\"../common/index\":2}]},{},[4]);\n\n//# sourceMappingURL=index.js.map\n"]}