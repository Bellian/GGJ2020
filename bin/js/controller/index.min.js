<<<<<<< Updated upstream
!function o(i,s,c){function l(t,e){if(!s[t]){if(!i[t]){var a="function"==typeof require&&require;if(!e&&a)return a(t,!0);if(u)return u(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var n=s[t]={exports:{}};i[t][0].call(n.exports,function(e){return l(i[t][1][e]||e)},n,n.exports,o,i,s,c)}return s[t].exports}for(var u="function"==typeof require&&require,e=0;e<c.length;e++)l(c[e]);return l}({1:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=e("./index"),r=(o.prototype.onUpdateServerData=function(e){this.updateServerCallbacks.add(e)},o.prototype.updateServerData=function(){var t=this;this.updateServerCallbacks.forEach(function(e){return e(t.serverData)})},o.prototype.currentPlayerData=function(){var t=this;return console.table("currentPlayerData playerData",this.playerData),console.table("currentPlayerData id",this.id),this.playerData.filter(function(e){return e.id===t.id})[0]},o.prototype.sendControllerData=function(e){e.id=this.id,this.notifyServer(e)},o.prototype.subscribeToAirConsole=function(){var r=this;this.airConsole.onMessage=function(e,t){if(t){var a=JSON.parse(t);switch(a.transactionType){case n.TransactionType.PlayerData:console.log("received player data",a),r.playerData=a.playerData;break;case n.TransactionType.ObjectData:console.log("received object data",a),r.objectData=a.objectData;break;case n.TransactionType.ServerData:console.log("received server data",a),r.serverData=a.serverData,r.updateServerData();break;default:console.error("client onMessage switch",t)}}else console.error("client onMessage",t)}},o.prototype.toggleAngryDad=function(){console.table("toggleAngryDad playerData",this.playerData),console.table("toggleAngryDad id",this.id);var e=this.currentPlayerData();return void 0===e.isAngryDad?e.isAngryDad=!1:e.isAngryDad=!e.isAngryDad,this.notifyServer(e),e.isAngryDad},o.prototype.changeAppearance=function(e){var t=this.currentPlayerData();return t.characterAppearanceType=e,this.notifyServer(t),t.characterAppearanceType},o.prototype.interacting=function(e){var t=this.currentPlayerData();return t.playerState=e,this.notifyServer(t),t.playerState},o.prototype.notifyServer=function(e){this.airConsole.message(AirConsole.SCREEN,JSON.stringify(e))},o.prototype.getTime=function(){return this.serverData.timerValueInSeconds},o);function o(){var t=this;this.id=0,this.playerData=[],this.objectData=[],this.updateServerCallbacks=new Set,this.serverData=new n.ServerData(30,n.ServerState.initial),this.airConsole=new AirConsole,this.airConsole.onDeviceStateChange=function(e){t.id=e,t.subscribeToAirConsole()}}a.Client=r},{"./index":2}],2:[function(e,t,a){"use strict";function r(e){for(var t in e)a.hasOwnProperty(t)||(a[t]=e[t])}Object.defineProperty(a,"__esModule",{value:!0}),r(e("./client")),r(e("./server"));function n(e,t,a){this.x=e,this.y=t,this.id=a,this.transactionType=o.PlayerData,this.playerState=u.idle,this.isAngryDad=!1,this.characterAppearanceType=p.wichtel1}var o,i,s;a.PlayerData=n,(i=o=a.TransactionType||(a.TransactionType={}))[i.ServerData=0]="ServerData",i[i.PlayerData=1]="PlayerData",i[i.ControllerData=2]="ControllerData",i[i.ObjectData=3]="ObjectData",(s=a.ServerState||(a.ServerState={}))[s.initial=0]="initial",s[s.lobby=1]="lobby",s[s.characterSelection=2]="characterSelection",s[s.running=3]="running",s[s.final=4]="final";function c(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=e,this.y=t,this.id=0,this.transactionType=o.ControllerData}a.ControllerData=c;function l(e,t){void 0===e&&(e=30),this.timerValueInSeconds=e,this.serverState=t}var u,d,p,y;a.ServerData=l,(d=u=a.PlayerState||(a.PlayerState={}))[d.idle=0]="idle",d[d.dead=1]="dead",d[d.running=2]="running",d[d.interacting=3]="interacting",(y=p=a.CharacterAppearanceType||(a.CharacterAppearanceType={}))[y.wichtel1=0]="wichtel1",y[y.wichtel2=1]="wichtel2",y[y.wichtel3=2]="wichtel3",y[y.wichtel4=3]="wichtel4";function h(e,t,a,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===a&&(a=0),this.x=e,this.y=t,this.damage=a,this.objectId=r}a.ObjectData=h},{"./client":1,"./server":3}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("./index");n.OBJECTDATAMAXHEALTH=10;var a=(r.prototype.onUpdateServerState=function(e){this.updateControllerCallbacks.add(e)},r.prototype.updateServerState=function(){var t=this;this.updateServerCallbacks.forEach(function(e){return e(t.serverData.serverState)})},r.prototype.onUpdateControllerData=function(e){this.updateControllerCallbacks.add(e)},r.prototype.updateControllerData=function(t){this.updateControllerCallbacks.forEach(function(e){return e(t)})},r.prototype.createAndUpdatePlayer=function(t){var e=this.playerData.find(function(e){return e.id===t.id});e?this.updatePlayer(t):(e=new o.PlayerData(0,0,t.id),this.playerData.push(e),this.startAfterFirstPlayerJoined())},r.prototype.startAfterFirstPlayerJoined=function(){var e=this;1==this.playerData.length&&(this.serverData.serverState=o.ServerState.lobby,this.updateServerState(),this.serverStateUpdate(30,o.ServerState.characterSelection,function(){console.log("changed server state to character selection"),e.serverStateUpdate(15,o.ServerState.running,function(){e.serverStateUpdate(300,o.ServerState.final,function(){})})}))},r.prototype.serverStateUpdate=function(e,t,a){var r=this,n=this.setAndStartTimer(e);setTimeout(function(){clearInterval(n),r.serverData.serverState=t,r.updateServerState(),r.serverData.serverState===o.ServerState.running&&r.setAngryDad(),a()},1e3*e)},r.prototype.setAngryDad=function(){var e=this.playerData.filter(function(e){e.isAngryDad}),t=e.length;if(console.log("wantAngryDads",e),console.log("countAngryDads",t),console.table("playerData",this.playerData),0===t){var a=Math.floor(Math.random()*this.playerData.length);this.playerData.map(function(e){return e.isAngryDad=!1}),this.playerData[a].isAngryDad=!0}if(1<t){var r=e[Math.floor(Math.random()*t)].id;this.playerData.map(function(e){return e.isAngryDad=!1}),this.playerData.filter(function(e){return e.id===r})[0].isAngryDad=!0}},r.prototype.setAndStartTimer=function(e){var t=this;return this.serverData.timerValueInSeconds=e,setInterval(function(){t.serverData.timerValueInSeconds&&t.serverData.timerValueInSeconds--},1e3)},r.prototype.updatePlayer=function(t){var e=this.playerData.find(function(e){return e.id===t.id});if(e){var a=this.playerData.indexOf(e);if((this.playerData[a]=t).playerState===o.PlayerState.interacting){var r={damage:0,x:0,y:0,objectId:0};r&&(r.damage+=t.isAngryDad?-1:1,r.damage>n.OBJECTDATAMAXHEALTH&&(r.damage=n.OBJECTDATAMAXHEALTH),r.damage<0&&(r.damage=0)),t.isAngryDad}}},r.prototype.sendAllClients=function(e){this.airConsole.broadcast(JSON.stringify(e))},r.prototype.onMessage=function(){var r=this;this.airConsole.onMessage=function(e,t){if(t){var a=JSON.parse(t);switch(a.transactionType){case o.TransactionType.PlayerData:r.createAndUpdatePlayer(a);break;case o.TransactionType.ControllerData:r.updateControllerData(a);break;default:console.error("server onMessage",t)}}}},r.prototype.subscribeToAirConsole=function(){var a=this;this.onMessage(),this.airConsole.onConnect=function(e){a.createAndUpdatePlayer({id:e}),a.sendPlayerToClient||(a.sendPlayerToClient=setInterval(function(){a.sendPlayerData(),a.sendServerData(),a.sendObjectData()},500))},this.airConsole.onDisconnect=function(t){a.playerData.splice(a.playerData.indexOf(a.playerData.filter(function(e){return e.id===t})[0]),1)}},r.prototype.sendPlayerData=function(){this.sendAllClients({transactionType:o.TransactionType.PlayerData,playerData:this.playerData})},r.prototype.sendObjectData=function(){this.sendAllClients({transactionType:o.TransactionType.ObjectData,objectData:this.objectData})},r.prototype.sendServerData=function(){this.sendAllClients({transactionType:o.TransactionType.ServerData,serverData:this.serverData})},r);function r(){this.playerData=[],this.objectData=[],this.updateServerCallbacks=new Set,this.updateControllerCallbacks=new Set,this.airConsole=new AirConsole,this.serverData=new o.ServerData(30,o.ServerState.initial),this.subscribeToAirConsole()}n.Server=a},{"./index":2}],4:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r,n,o=e("../common/index");(n=r=a.Views||(a.Views={}))[n.splashscreen=0]="splashscreen",n[n.characterselection=1]="characterselection",n[n.playscreen=2]="playscreen";var i=(s.prototype.onJoystickMove=function(e){this.joystickMoveCallbacks.add(e)},s.prototype.updateJoystickPosition=function(t){this.joystickMoveCallbacks.forEach(function(e){return e(t)})},s.prototype.showView=function(e){document.querySelectorAll(r[e])[0].classList.add("visible"),document.querySelectorAll(".view").forEach(function(e){return e.classList.remove("visible")})},s.prototype.updateView=function(e){switch(e){case"join":this.showView(r.splashscreen),this.lobby();break;case"choose":this.showView(r.characterselection),this.characterselection();break;case"game":this.showView(r.playscreen),this.virtualController();break;default:console.error("not implemented",e)}},s.prototype.virtualController=function(){var t=this;document.querySelectorAll("playscreen > controller")[0].addEventListener("touchstart",function(e){t.startPos=[e.targetTouches[0].clientX,e.targetTouches[0].clientY]}),document.querySelectorAll("playscreen > controller")[0].addEventListener("touchmove",function(e){void 0!==t.startPos&&t.updateJoystickPosition({x:e.targetTouches[0].clientX-t.startPos[0],y:-(e.targetTouches[0].clientY-t.startPos[1])})}),document.querySelectorAll("playscreen > controller")[0].addEventListener("touchend",function(e){t.startPos=void 0})},s.prototype.lobby=function(){this.setTime(r.splashscreen,30)},s.prototype.characterselection=function(){document.querySelectorAll("characterselection > characters > img").forEach(function(e){return e.addEventListener("click",function(){e.classList.contains("angry-dad")?(document.querySelectorAll("characterselection")[0].classList.add("isAngryDad"),console.log("You would like to be angry dad!")):(document.querySelectorAll("characterselection")[0].classList.remove("isAngryDad"),console.log("You would like to be a wichtel!"))})}),this.setTime(r.characterselection,15)},s.prototype.setTime=function(e,t){var a=setInterval(function(){document.querySelectorAll(r[e]+" time")[0].innerHTML=t.toString(),--t<=0&&clearInterval(a)},1e3)},s);function s(e){this.client=e,this.startPos=void 0,this.joystickMoveCallbacks=new Set,this.client.onUpdateServerData(this.updateView.bind(this))}document.addEventListener("DOMContentLoaded",function(){var e=new o.Client,t=new i(e);t.virtualController(),t.onJoystickMove(function(e){console.log(e)})})},{"../common/index":2}]},{},[4]);
=======
!function o(i,u,s){function c(e,t){if(!u[e]){if(!i[e]){var r="function"==typeof require&&require;if(!t&&r)return r(e,!0);if(h)return h(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var a=u[e]={exports:{}};i[e][0].call(a.exports,function(t){return c(i[e][1][t]||t)},a,a.exports,o,i,u,s)}return u[e].exports}for(var h="function"==typeof require&&require,t=0;t<s.length;t++)c(s[t]);return c}({1:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.setMatrixArrayType=function(t){r.ARRAY_TYPE=a=t},r.toRadian=function(t){return t*i},r.equals=function(t,e){return Math.abs(t-e)<=n*Math.max(1,Math.abs(t),Math.abs(e))},r.RANDOM=r.ARRAY_TYPE=r.EPSILON=void 0;var n=1e-6;r.EPSILON=n;var a="undefined"!=typeof Float32Array?Float32Array:Array;r.ARRAY_TYPE=a;var o=Math.random;r.RANDOM=o;var i=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},{}],2:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.vec4=r.vec3=r.vec2=r.quat2=r.quat=r.mat4=r.mat3=r.mat2d=r.mat2=r.glMatrix=void 0;var n=v(t("./common.js"));r.glMatrix=n;var a=v(t("./mat2.js"));r.mat2=a;var o=v(t("./mat2d.js"));r.mat2d=o;var i=v(t("./mat3.js"));r.mat3=i;var u=v(t("./mat4.js"));r.mat4=u;var s=v(t("./quat.js"));r.quat=s;var c=v(t("./quat2.js"));r.quat2=c;var h=v(t("./vec2.js"));r.vec2=h;var l=v(t("./vec3.js"));r.vec3=l;var f=v(t("./vec4.js"));function v(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}r.vec4=f},{"./common.js":1,"./mat2.js":3,"./mat2d.js":4,"./mat3.js":5,"./mat4.js":6,"./quat.js":7,"./quat2.js":8,"./vec2.js":9,"./vec3.js":10,"./vec4.js":11}],3:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var t=new h.ARRAY_TYPE(4);h.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0);return t[0]=1,t[3]=1,t},r.clone=function(t){var e=new h.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},r.fromValues=function(t,e,r,n){var a=new h.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=r,a[3]=n,a},r.set=function(t,e,r,n,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t},r.transpose=function(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},r.invert=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r*o-a*n;return i?(i=1/i,t[0]=o*i,t[1]=-n*i,t[2]=-a*i,t[3]=r*i,t):null},r.adjoint=function(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},r.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},r.multiply=n,r.rotate=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=n*s+o*u,t[1]=a*s+i*u,t[2]=n*-u+o*s,t[3]=a*-u+i*s,t},r.scale=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=r[0],s=r[1];return t[0]=n*u,t[1]=a*u,t[2]=o*s,t[3]=i*s,t},r.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},r.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},r.LDU=function(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},r.subtract=a,r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},r.equals=function(t,e){var r=t[0],n=t[1],a=t[2],o=t[3],i=e[0],u=e[1],s=e[2],c=e[3];return Math.abs(r-i)<=h.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-u)<=h.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(a-s)<=h.EPSILON*Math.max(1,Math.abs(a),Math.abs(s))&&Math.abs(o-c)<=h.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))},r.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},r.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},r.sub=r.mul=void 0;var h=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}}(t("./common.js"));function n(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=r[0],s=r[1],c=r[2],h=r[3];return t[0]=n*u+o*s,t[1]=a*u+i*s,t[2]=n*c+o*h,t[3]=a*c+i*h,t}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}var o=n;r.mul=o;var i=a;r.sub=i},{"./common.js":1}],4:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var t=new M.ARRAY_TYPE(6);M.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0);return t[0]=1,t[3]=1,t},r.clone=function(t){var e=new M.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},r.fromValues=function(t,e,r,n,a,o){var i=new M.ARRAY_TYPE(6);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i[4]=a,i[5]=o,i},r.set=function(t,e,r,n,a,o,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=o,t[5]=i,t},r.invert=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],u=e[5],s=r*o-n*a;return s?(s=1/s,t[0]=o*s,t[1]=-n*s,t[2]=-a*s,t[3]=r*s,t[4]=(a*u-o*i)*s,t[5]=(n*i-r*u)*s,t):null},r.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},r.multiply=n,r.rotate=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=e[4],s=e[5],c=Math.sin(r),h=Math.cos(r);return t[0]=n*h+o*c,t[1]=a*h+i*c,t[2]=n*-c+o*h,t[3]=a*-c+i*h,t[4]=u,t[5]=s,t},r.scale=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=e[4],s=e[5],c=r[0],h=r[1];return t[0]=n*c,t[1]=a*c,t[2]=o*h,t[3]=i*h,t[4]=u,t[5]=s,t},r.translate=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=e[4],s=e[5],c=r[0],h=r[1];return t[0]=n,t[1]=a,t[2]=o,t[3]=i,t[4]=n*c+o*h+u,t[5]=a*c+i*h+s,t},r.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t[4]=0,t[5]=0,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},r.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},r.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t},r.subtract=a,r.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t},r.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},r.equals=function(t,e){var r=t[0],n=t[1],a=t[2],o=t[3],i=t[4],u=t[5],s=e[0],c=e[1],h=e[2],l=e[3],f=e[4],v=e[5];return Math.abs(r-s)<=M.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-c)<=M.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(a-h)<=M.EPSILON*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(o-l)<=M.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(i-f)<=M.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(u-v)<=M.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))},r.sub=r.mul=void 0;var M=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}}(t("./common.js"));function n(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=e[4],s=e[5],c=r[0],h=r[1],l=r[2],f=r[3],v=r[4],M=r[5];return t[0]=n*c+o*h,t[1]=a*c+i*h,t[2]=n*l+o*f,t[3]=a*l+i*f,t[4]=n*v+o*M+u,t[5]=a*v+i*M+s,t}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t}var o=n;r.mul=o;var i=a;r.sub=i},{"./common.js":1}],5:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var t=new P.ARRAY_TYPE(9);P.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0);return t[0]=1,t[4]=1,t[8]=1,t},r.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},r.clone=function(t){var e=new P.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},r.fromValues=function(t,e,r,n,a,o,i,u,s){var c=new P.ARRAY_TYPE(9);return c[0]=t,c[1]=e,c[2]=r,c[3]=n,c[4]=a,c[5]=o,c[6]=i,c[7]=u,c[8]=s,c},r.set=function(t,e,r,n,a,o,i,u,s,c){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=o,t[5]=i,t[6]=u,t[7]=s,t[8]=c,t},r.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},r.invert=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],u=e[5],s=e[6],c=e[7],h=e[8],l=h*i-u*c,f=-h*o+u*s,v=c*o-i*s,M=r*l+n*f+a*v;return M?(M=1/M,t[0]=l*M,t[1]=(-h*n+a*c)*M,t[2]=(u*n-a*i)*M,t[3]=f*M,t[4]=(h*r-a*s)*M,t[5]=(-u*r+a*o)*M,t[6]=v*M,t[7]=(-c*r+n*s)*M,t[8]=(i*r-n*o)*M,t):null},r.adjoint=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],u=e[5],s=e[6],c=e[7],h=e[8];return t[0]=i*h-u*c,t[1]=a*c-n*h,t[2]=n*u-a*i,t[3]=u*s-o*h,t[4]=r*h-a*s,t[5]=a*o-r*u,t[6]=o*c-i*s,t[7]=n*s-r*c,t[8]=r*i-n*o,t},r.determinant=function(t){var e=t[0],r=t[1],n=t[2],a=t[3],o=t[4],i=t[5],u=t[6],s=t[7],c=t[8];return e*(c*o-i*s)+r*(-c*a+i*u)+n*(s*a-o*u)},r.multiply=n,r.translate=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=e[4],s=e[5],c=e[6],h=e[7],l=e[8],f=r[0],v=r[1];return t[0]=n,t[1]=a,t[2]=o,t[3]=i,t[4]=u,t[5]=s,t[6]=f*n+v*i+c,t[7]=f*a+v*u+h,t[8]=f*o+v*s+l,t},r.rotate=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=e[4],s=e[5],c=e[6],h=e[7],l=e[8],f=Math.sin(r),v=Math.cos(r);return t[0]=v*n+f*i,t[1]=v*a+f*u,t[2]=v*o+f*s,t[3]=v*i-f*n,t[4]=v*u-f*a,t[5]=v*s-f*o,t[6]=c,t[7]=h,t[8]=l,t},r.scale=function(t,e,r){var n=r[0],a=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=a*e[3],t[4]=a*e[4],t[5]=a*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},r.fromRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},r.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},r.fromQuat=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r+r,u=n+n,s=a+a,c=r*i,h=n*i,l=n*u,f=a*i,v=a*u,M=a*s,d=o*i,p=o*u,m=o*s;return t[0]=1-l-M,t[3]=h-m,t[6]=f+p,t[1]=h+m,t[4]=1-c-M,t[7]=v-d,t[2]=f-p,t[5]=v+d,t[8]=1-c-l,t},r.normalFromMat4=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],u=e[5],s=e[6],c=e[7],h=e[8],l=e[9],f=e[10],v=e[11],M=e[12],d=e[13],p=e[14],m=e[15],b=r*u-n*i,y=r*s-a*i,P=r*c-o*i,g=n*s-a*u,O=n*c-o*u,S=a*c-o*s,A=h*d-l*M,D=h*p-f*M,E=h*m-v*M,j=l*p-f*d,w=l*m-v*d,_=f*m-v*p,R=b*_-y*w+P*j+g*E-O*D+S*A;return R?(R=1/R,t[0]=(u*_-s*w+c*j)*R,t[1]=(s*E-i*_-c*D)*R,t[2]=(i*w-u*E+c*A)*R,t[3]=(a*w-n*_-o*j)*R,t[4]=(r*_-a*E+o*D)*R,t[5]=(n*E-r*w-o*A)*R,t[6]=(d*S-p*O+m*g)*R,t[7]=(p*P-M*S-m*y)*R,t[8]=(M*O-d*P+m*b)*R,t):null},r.projection=function(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},r.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},r.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t},r.subtract=a,r.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t},r.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},r.equals=function(t,e){var r=t[0],n=t[1],a=t[2],o=t[3],i=t[4],u=t[5],s=t[6],c=t[7],h=t[8],l=e[0],f=e[1],v=e[2],M=e[3],d=e[4],p=e[5],m=e[6],b=e[7],y=e[8];return Math.abs(r-l)<=P.EPSILON*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(n-f)<=P.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(a-v)<=P.EPSILON*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(o-M)<=P.EPSILON*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(i-d)<=P.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(u-p)<=P.EPSILON*Math.max(1,Math.abs(u),Math.abs(p))&&Math.abs(s-m)<=P.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(c-b)<=P.EPSILON*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(h-y)<=P.EPSILON*Math.max(1,Math.abs(h),Math.abs(y))},r.sub=r.mul=void 0;var P=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}}(t("./common.js"));function n(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=e[4],s=e[5],c=e[6],h=e[7],l=e[8],f=r[0],v=r[1],M=r[2],d=r[3],p=r[4],m=r[5],b=r[6],y=r[7],P=r[8];return t[0]=f*n+v*i+M*c,t[1]=f*a+v*u+M*h,t[2]=f*o+v*s+M*l,t[3]=d*n+p*i+m*c,t[4]=d*a+p*u+m*h,t[5]=d*o+p*s+m*l,t[6]=b*n+y*i+P*c,t[7]=b*a+y*u+P*h,t[8]=b*o+y*s+P*l,t}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}var o=n;r.mul=o;var i=a;r.sub=i},{"./common.js":1}],6:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var t=new T.ARRAY_TYPE(16);T.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},r.clone=function(t){var e=new T.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.fromValues=function(t,e,r,n,a,o,i,u,s,c,h,l,f,v,M,d){var p=new T.ARRAY_TYPE(16);return p[0]=t,p[1]=e,p[2]=r,p[3]=n,p[4]=a,p[5]=o,p[6]=i,p[7]=u,p[8]=s,p[9]=c,p[10]=h,p[11]=l,p[12]=f,p[13]=v,p[14]=M,p[15]=d,p},r.set=function(t,e,r,n,a,o,i,u,s,c,h,l,f,v,M,d,p){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=o,t[5]=i,t[6]=u,t[7]=s,t[8]=c,t[9]=h,t[10]=l,t[11]=f,t[12]=v,t[13]=M,t[14]=d,t[15]=p,t},r.identity=S,r.transpose=function(t,e){if(t===e){var r=e[1],n=e[2],a=e[3],o=e[6],i=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=a,t[13]=i,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},r.invert=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],u=e[5],s=e[6],c=e[7],h=e[8],l=e[9],f=e[10],v=e[11],M=e[12],d=e[13],p=e[14],m=e[15],b=r*u-n*i,y=r*s-a*i,P=r*c-o*i,g=n*s-a*u,O=n*c-o*u,S=a*c-o*s,A=h*d-l*M,D=h*p-f*M,E=h*m-v*M,j=l*p-f*d,w=l*m-v*d,_=f*m-v*p,R=b*_-y*w+P*j+g*E-O*D+S*A;return R?(R=1/R,t[0]=(u*_-s*w+c*j)*R,t[1]=(a*w-n*_-o*j)*R,t[2]=(d*S-p*O+m*g)*R,t[3]=(f*O-l*S-v*g)*R,t[4]=(s*E-i*_-c*D)*R,t[5]=(r*_-a*E+o*D)*R,t[6]=(p*P-M*S-m*y)*R,t[7]=(h*S-f*P+v*y)*R,t[8]=(i*w-u*E+c*A)*R,t[9]=(n*E-r*w-o*A)*R,t[10]=(M*O-d*P+m*b)*R,t[11]=(l*P-h*O-v*b)*R,t[12]=(u*D-i*j-s*A)*R,t[13]=(r*j-n*D+a*A)*R,t[14]=(d*y-M*g-p*b)*R,t[15]=(h*g-l*y+f*b)*R,t):null},r.adjoint=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=e[4],u=e[5],s=e[6],c=e[7],h=e[8],l=e[9],f=e[10],v=e[11],M=e[12],d=e[13],p=e[14],m=e[15];return t[0]=u*(f*m-v*p)-l*(s*m-c*p)+d*(s*v-c*f),t[1]=-(n*(f*m-v*p)-l*(a*m-o*p)+d*(a*v-o*f)),t[2]=n*(s*m-c*p)-u*(a*m-o*p)+d*(a*c-o*s),t[3]=-(n*(s*v-c*f)-u*(a*v-o*f)+l*(a*c-o*s)),t[4]=-(i*(f*m-v*p)-h*(s*m-c*p)+M*(s*v-c*f)),t[5]=r*(f*m-v*p)-h*(a*m-o*p)+M*(a*v-o*f),t[6]=-(r*(s*m-c*p)-i*(a*m-o*p)+M*(a*c-o*s)),t[7]=r*(s*v-c*f)-i*(a*v-o*f)+h*(a*c-o*s),t[8]=i*(l*m-v*d)-h*(u*m-c*d)+M*(u*v-c*l),t[9]=-(r*(l*m-v*d)-h*(n*m-o*d)+M*(n*v-o*l)),t[10]=r*(u*m-c*d)-i*(n*m-o*d)+M*(n*c-o*u),t[11]=-(r*(u*v-c*l)-i*(n*v-o*l)+h*(n*c-o*u)),t[12]=-(i*(l*p-f*d)-h*(u*p-s*d)+M*(u*f-s*l)),t[13]=r*(l*p-f*d)-h*(n*p-a*d)+M*(n*f-a*l),t[14]=-(r*(u*p-s*d)-i*(n*p-a*d)+M*(n*s-a*u)),t[15]=r*(u*f-s*l)-i*(n*f-a*l)+h*(n*s-a*u),t},r.determinant=function(t){var e=t[0],r=t[1],n=t[2],a=t[3],o=t[4],i=t[5],u=t[6],s=t[7],c=t[8],h=t[9],l=t[10],f=t[11],v=t[12],M=t[13],d=t[14],p=t[15];return(e*i-r*o)*(l*p-f*d)-(e*u-n*o)*(h*p-f*M)+(e*s-a*o)*(h*d-l*M)+(r*u-n*i)*(c*p-f*v)-(r*s-a*i)*(c*d-l*v)+(n*s-a*u)*(c*M-h*v)},r.multiply=n,r.translate=function(t,e,r){var n,a,o,i,u,s,c,h,l,f,v,M,d=r[0],p=r[1],m=r[2];e===t?(t[12]=e[0]*d+e[4]*p+e[8]*m+e[12],t[13]=e[1]*d+e[5]*p+e[9]*m+e[13],t[14]=e[2]*d+e[6]*p+e[10]*m+e[14],t[15]=e[3]*d+e[7]*p+e[11]*m+e[15]):(n=e[0],a=e[1],o=e[2],i=e[3],u=e[4],s=e[5],c=e[6],h=e[7],l=e[8],f=e[9],v=e[10],M=e[11],t[0]=n,t[1]=a,t[2]=o,t[3]=i,t[4]=u,t[5]=s,t[6]=c,t[7]=h,t[8]=l,t[9]=f,t[10]=v,t[11]=M,t[12]=n*d+u*p+l*m+e[12],t[13]=a*d+s*p+f*m+e[13],t[14]=o*d+c*p+v*m+e[14],t[15]=i*d+h*p+M*m+e[15]);return t},r.scale=function(t,e,r){var n=r[0],a=r[1],o=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},r.rotate=function(t,e,r,n){var a,o,i,u,s,c,h,l,f,v,M,d,p,m,b,y,P,g,O,S,A,D,E,j,w=n[0],_=n[1],R=n[2],x=Math.hypot(w,_,R);if(x<T.EPSILON)return null;w*=x=1/x,_*=x,R*=x,a=Math.sin(r),o=Math.cos(r),i=1-o,u=e[0],s=e[1],c=e[2],h=e[3],l=e[4],f=e[5],v=e[6],M=e[7],d=e[8],p=e[9],m=e[10],b=e[11],y=w*w*i+o,P=_*w*i+R*a,g=R*w*i-_*a,O=w*_*i-R*a,S=_*_*i+o,A=R*_*i+w*a,D=w*R*i+_*a,E=_*R*i-w*a,j=R*R*i+o,t[0]=u*y+l*P+d*g,t[1]=s*y+f*P+p*g,t[2]=c*y+v*P+m*g,t[3]=h*y+M*P+b*g,t[4]=u*O+l*S+d*A,t[5]=s*O+f*S+p*A,t[6]=c*O+v*S+m*A,t[7]=h*O+M*S+b*A,t[8]=u*D+l*E+d*j,t[9]=s*D+f*E+p*j,t[10]=c*D+v*E+m*j,t[11]=h*D+M*E+b*j,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t},r.rotateX=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),o=e[4],i=e[5],u=e[6],s=e[7],c=e[8],h=e[9],l=e[10],f=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[4]=o*a+c*n,t[5]=i*a+h*n,t[6]=u*a+l*n,t[7]=s*a+f*n,t[8]=c*a-o*n,t[9]=h*a-i*n,t[10]=l*a-u*n,t[11]=f*a-s*n,t},r.rotateY=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),o=e[0],i=e[1],u=e[2],s=e[3],c=e[8],h=e[9],l=e[10],f=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=o*a-c*n,t[1]=i*a-h*n,t[2]=u*a-l*n,t[3]=s*a-f*n,t[8]=o*n+c*a,t[9]=i*n+h*a,t[10]=u*n+l*a,t[11]=s*n+f*a,t},r.rotateZ=function(t,e,r){var n=Math.sin(r),a=Math.cos(r),o=e[0],i=e[1],u=e[2],s=e[3],c=e[4],h=e[5],l=e[6],f=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=o*a+c*n,t[1]=i*a+h*n,t[2]=u*a+l*n,t[3]=s*a+f*n,t[4]=c*a-o*n,t[5]=h*a-i*n,t[6]=l*a-u*n,t[7]=f*a-s*n,t},r.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},r.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotation=function(t,e,r){var n,a,o,i=r[0],u=r[1],s=r[2],c=Math.hypot(i,u,s);if(c<T.EPSILON)return null;return i*=c=1/c,u*=c,s*=c,n=Math.sin(e),a=Math.cos(e),o=1-a,t[0]=i*i*o+a,t[1]=u*i*o+s*n,t[2]=s*i*o-u*n,t[3]=0,t[4]=i*u*o-s*n,t[5]=u*u*o+a,t[6]=s*u*o+i*n,t[7]=0,t[8]=i*s*o+u*n,t[9]=u*s*o-i*n,t[10]=s*s*o+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromXRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromYRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromZRotation=function(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.fromRotationTranslation=f,r.fromQuat2=function(t,e){var r=new T.ARRAY_TYPE(3),n=-e[0],a=-e[1],o=-e[2],i=e[3],u=e[4],s=e[5],c=e[6],h=e[7],l=n*n+a*a+o*o+i*i;0<l?(r[0]=2*(u*i+h*n+s*o-c*a)/l,r[1]=2*(s*i+h*a+c*n-u*o)/l,r[2]=2*(c*i+h*o+u*a-s*n)/l):(r[0]=2*(u*i+h*n+s*o-c*a),r[1]=2*(s*i+h*a+c*n-u*o),r[2]=2*(c*i+h*o+u*a-s*n));return f(t,e,r),t},r.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},r.getScaling=m,r.getRotation=function(t,e){var r=new T.ARRAY_TYPE(3);m(r,e);var n=1/r[0],a=1/r[1],o=1/r[2],i=e[0]*n,u=e[1]*a,s=e[2]*o,c=e[4]*n,h=e[5]*a,l=e[6]*o,f=e[8]*n,v=e[9]*a,M=e[10]*o,d=i+h+M,p=0;0<d?(p=2*Math.sqrt(1+d),t[3]=.25*p,t[0]=(l-v)/p,t[1]=(f-s)/p,t[2]=(u-c)/p):h<i&&M<i?(p=2*Math.sqrt(1+i-h-M),t[3]=(l-v)/p,t[0]=.25*p,t[1]=(u+c)/p,t[2]=(f+s)/p):M<h?(p=2*Math.sqrt(1+h-i-M),t[3]=(f-s)/p,t[0]=(u+c)/p,t[1]=.25*p,t[2]=(l+v)/p):(p=2*Math.sqrt(1+M-i-h),t[3]=(u-c)/p,t[0]=(f+s)/p,t[1]=(l+v)/p,t[2]=.25*p);return t},r.fromRotationTranslationScale=function(t,e,r,n){var a=e[0],o=e[1],i=e[2],u=e[3],s=a+a,c=o+o,h=i+i,l=a*s,f=a*c,v=a*h,M=o*c,d=o*h,p=i*h,m=u*s,b=u*c,y=u*h,P=n[0],g=n[1],O=n[2];return t[0]=(1-(M+p))*P,t[1]=(f+y)*P,t[2]=(v-b)*P,t[3]=0,t[4]=(f-y)*g,t[5]=(1-(l+p))*g,t[6]=(d+m)*g,t[7]=0,t[8]=(v+b)*O,t[9]=(d-m)*O,t[10]=(1-(l+M))*O,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},r.fromRotationTranslationScaleOrigin=function(t,e,r,n,a){var o=e[0],i=e[1],u=e[2],s=e[3],c=o+o,h=i+i,l=u+u,f=o*c,v=o*h,M=o*l,d=i*h,p=i*l,m=u*l,b=s*c,y=s*h,P=s*l,g=n[0],O=n[1],S=n[2],A=a[0],D=a[1],E=a[2],j=(1-(d+m))*g,w=(v+P)*g,_=(M-y)*g,R=(v-P)*O,x=(1-(f+m))*O,L=(p+b)*O,q=(M+y)*S,T=(p-b)*S,I=(1-(f+d))*S;return t[0]=j,t[1]=w,t[2]=_,t[3]=0,t[4]=R,t[5]=x,t[6]=L,t[7]=0,t[8]=q,t[9]=T,t[10]=I,t[11]=0,t[12]=r[0]+A-(j*A+R*D+q*E),t[13]=r[1]+D-(w*A+x*D+T*E),t[14]=r[2]+E-(_*A+L*D+I*E),t[15]=1,t},r.fromQuat=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r+r,u=n+n,s=a+a,c=r*i,h=n*i,l=n*u,f=a*i,v=a*u,M=a*s,d=o*i,p=o*u,m=o*s;return t[0]=1-l-M,t[1]=h+m,t[2]=f-p,t[3]=0,t[4]=h-m,t[5]=1-c-M,t[6]=v+d,t[7]=0,t[8]=f+p,t[9]=v-d,t[10]=1-c-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},r.frustum=function(t,e,r,n,a,o,i){var u=1/(r-e),s=1/(a-n),c=1/(o-i);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*s,t[6]=0,t[7]=0,t[8]=(r+e)*u,t[9]=(a+n)*s,t[10]=(i+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=i*o*2*c,t[15]=0,t},r.perspective=function(t,e,r,n,a){var o,i=1/Math.tan(e/2);t[0]=i/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=a&&a!==1/0?(o=1/(n-a),t[10]=(a+n)*o,t[14]=2*a*n*o):(t[10]=-1,t[14]=-2*n);return t},r.perspectiveFromFieldOfView=function(t,e,r,n){var a=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),i=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),s=2/(i+u),c=2/(a+o);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(i-u)*s*.5,t[9]=(a-o)*c*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t},r.ortho=function(t,e,r,n,a,o,i){var u=1/(e-r),s=1/(n-a),c=1/(o-i);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*u,t[13]=(a+n)*s,t[14]=(i+o)*c,t[15]=1,t},r.lookAt=function(t,e,r,n){var a,o,i,u,s,c,h,l,f,v,M=e[0],d=e[1],p=e[2],m=n[0],b=n[1],y=n[2],P=r[0],g=r[1],O=r[2];if(Math.abs(M-P)<T.EPSILON&&Math.abs(d-g)<T.EPSILON&&Math.abs(p-O)<T.EPSILON)return S(t);h=M-P,l=d-g,f=p-O,v=1/Math.hypot(h,l,f),a=b*(f*=v)-y*(l*=v),o=y*(h*=v)-m*f,i=m*l-b*h,(v=Math.hypot(a,o,i))?(a*=v=1/v,o*=v,i*=v):i=o=a=0;u=l*i-f*o,s=f*a-h*i,c=h*o-l*a,(v=Math.hypot(u,s,c))?(u*=v=1/v,s*=v,c*=v):c=s=u=0;return t[0]=a,t[1]=u,t[2]=h,t[3]=0,t[4]=o,t[5]=s,t[6]=l,t[7]=0,t[8]=i,t[9]=c,t[10]=f,t[11]=0,t[12]=-(a*M+o*d+i*p),t[13]=-(u*M+s*d+c*p),t[14]=-(h*M+l*d+f*p),t[15]=1,t},r.targetTo=function(t,e,r,n){var a=e[0],o=e[1],i=e[2],u=n[0],s=n[1],c=n[2],h=a-r[0],l=o-r[1],f=i-r[2],v=h*h+l*l+f*f;0<v&&(v=1/Math.sqrt(v),h*=v,l*=v,f*=v);var M=s*f-c*l,d=c*h-u*f,p=u*l-s*h;0<(v=M*M+d*d+p*p)&&(v=1/Math.sqrt(v),M*=v,d*=v,p*=v);return t[0]=M,t[1]=d,t[2]=p,t[3]=0,t[4]=l*p-f*d,t[5]=f*M-h*p,t[6]=h*d-l*M,t[7]=0,t[8]=h,t[9]=l,t[10]=f,t[11]=0,t[12]=a,t[13]=o,t[14]=i,t[15]=1,t},r.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},r.frob=function(t){return Math.hypot(t[0],t[1],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t},r.subtract=a,r.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t},r.multiplyScalarAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},r.equals=function(t,e){var r=t[0],n=t[1],a=t[2],o=t[3],i=t[4],u=t[5],s=t[6],c=t[7],h=t[8],l=t[9],f=t[10],v=t[11],M=t[12],d=t[13],p=t[14],m=t[15],b=e[0],y=e[1],P=e[2],g=e[3],O=e[4],S=e[5],A=e[6],D=e[7],E=e[8],j=e[9],w=e[10],_=e[11],R=e[12],x=e[13],L=e[14],q=e[15];return Math.abs(r-b)<=T.EPSILON*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(n-y)<=T.EPSILON*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(a-P)<=T.EPSILON*Math.max(1,Math.abs(a),Math.abs(P))&&Math.abs(o-g)<=T.EPSILON*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(i-O)<=T.EPSILON*Math.max(1,Math.abs(i),Math.abs(O))&&Math.abs(u-S)<=T.EPSILON*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(s-A)<=T.EPSILON*Math.max(1,Math.abs(s),Math.abs(A))&&Math.abs(c-D)<=T.EPSILON*Math.max(1,Math.abs(c),Math.abs(D))&&Math.abs(h-E)<=T.EPSILON*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(l-j)<=T.EPSILON*Math.max(1,Math.abs(l),Math.abs(j))&&Math.abs(f-w)<=T.EPSILON*Math.max(1,Math.abs(f),Math.abs(w))&&Math.abs(v-_)<=T.EPSILON*Math.max(1,Math.abs(v),Math.abs(_))&&Math.abs(M-R)<=T.EPSILON*Math.max(1,Math.abs(M),Math.abs(R))&&Math.abs(d-x)<=T.EPSILON*Math.max(1,Math.abs(d),Math.abs(x))&&Math.abs(p-L)<=T.EPSILON*Math.max(1,Math.abs(p),Math.abs(L))&&Math.abs(m-q)<=T.EPSILON*Math.max(1,Math.abs(m),Math.abs(q))},r.sub=r.mul=void 0;var T=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}}(t("./common.js"));function S(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function n(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=e[4],s=e[5],c=e[6],h=e[7],l=e[8],f=e[9],v=e[10],M=e[11],d=e[12],p=e[13],m=e[14],b=e[15],y=r[0],P=r[1],g=r[2],O=r[3];return t[0]=y*n+P*u+g*l+O*d,t[1]=y*a+P*s+g*f+O*p,t[2]=y*o+P*c+g*v+O*m,t[3]=y*i+P*h+g*M+O*b,y=r[4],P=r[5],g=r[6],O=r[7],t[4]=y*n+P*u+g*l+O*d,t[5]=y*a+P*s+g*f+O*p,t[6]=y*o+P*c+g*v+O*m,t[7]=y*i+P*h+g*M+O*b,y=r[8],P=r[9],g=r[10],O=r[11],t[8]=y*n+P*u+g*l+O*d,t[9]=y*a+P*s+g*f+O*p,t[10]=y*o+P*c+g*v+O*m,t[11]=y*i+P*h+g*M+O*b,y=r[12],P=r[13],g=r[14],O=r[15],t[12]=y*n+P*u+g*l+O*d,t[13]=y*a+P*s+g*f+O*p,t[14]=y*o+P*c+g*v+O*m,t[15]=y*i+P*h+g*M+O*b,t}function f(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=n+n,s=a+a,c=o+o,h=n*u,l=n*s,f=n*c,v=a*s,M=a*c,d=o*c,p=i*u,m=i*s,b=i*c;return t[0]=1-(v+d),t[1]=l+b,t[2]=f-m,t[3]=0,t[4]=l-b,t[5]=1-(h+d),t[6]=M+p,t[7]=0,t[8]=f+m,t[9]=M-p,t[10]=1-(h+v),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function m(t,e){var r=e[0],n=e[1],a=e[2],o=e[4],i=e[5],u=e[6],s=e[8],c=e[9],h=e[10];return t[0]=Math.hypot(r,n,a),t[1]=Math.hypot(o,i,u),t[2]=Math.hypot(s,c,h),t}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}var o=n;r.mul=o;var i=a;r.sub=i},{"./common.js":1}],7:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.create=u,r.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},r.setAxisAngle=s,r.getAxisAngle=function(t,e){var r=2*Math.acos(e[3]),n=Math.sin(r/2);n>m.EPSILON?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0);return r},r.getAngle=function(t,e){var r=O(t,e);return Math.acos(2*r*r-1)},r.multiply=c,r.rotateX=function(t,e,r){r*=.5;var n=e[0],a=e[1],o=e[2],i=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=n*s+i*u,t[1]=a*s+o*u,t[2]=o*s-a*u,t[3]=i*s-n*u,t},r.rotateY=function(t,e,r){r*=.5;var n=e[0],a=e[1],o=e[2],i=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=n*s-o*u,t[1]=a*s+i*u,t[2]=o*s+n*u,t[3]=i*s-a*u,t},r.rotateZ=function(t,e,r){r*=.5;var n=e[0],a=e[1],o=e[2],i=e[3],u=Math.sin(r),s=Math.cos(r);return t[0]=n*s+a*u,t[1]=a*s-n*u,t[2]=o*s+i*u,t[3]=i*s-o*u,t},r.calculateW=function(t,e){var r=e[0],n=e[1],a=e[2];return t[0]=r,t[1]=n,t[2]=a,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-a*a)),t},r.exp=h,r.ln=l,r.pow=function(t,e,r){return l(t,e),g(t,t,r),h(t,t),t},r.slerp=f,r.random=function(t){var e=m.RANDOM(),r=m.RANDOM(),n=m.RANDOM(),a=Math.sqrt(1-e),o=Math.sqrt(e);return t[0]=a*Math.sin(2*Math.PI*r),t[1]=a*Math.cos(2*Math.PI*r),t[2]=o*Math.sin(2*Math.PI*n),t[3]=o*Math.cos(2*Math.PI*n),t},r.invert=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r*r+n*n+a*a+o*o,u=i?1/i:0;return t[0]=-r*u,t[1]=-n*u,t[2]=-a*u,t[3]=o*u,t},r.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},r.fromMat3=v,r.fromEuler=function(t,e,r,n){var a=.5*Math.PI/180;e*=a,r*=a,n*=a;var o=Math.sin(e),i=Math.cos(e),u=Math.sin(r),s=Math.cos(r),c=Math.sin(n),h=Math.cos(n);return t[0]=o*s*h-i*u*c,t[1]=i*u*h+o*s*c,t[2]=i*s*c-o*u*h,t[3]=i*s*h+o*u*c,t},r.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.setAxes=r.sqlerp=r.rotationTo=r.equals=r.exactEquals=r.normalize=r.sqrLen=r.squaredLength=r.len=r.length=r.lerp=r.dot=r.scale=r.mul=r.add=r.set=r.copy=r.fromValues=r.clone=void 0;var m=i(t("./common.js")),n=i(t("./mat3.js")),a=i(t("./vec3.js")),o=i(t("./vec4.js"));function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}function u(){var t=new m.ARRAY_TYPE(4);return m.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function s(t,e,r){r*=.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function c(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=r[0],s=r[1],c=r[2],h=r[3];return t[0]=n*h+i*u+a*c-o*s,t[1]=a*h+i*s+o*u-n*c,t[2]=o*h+i*c+n*s-a*u,t[3]=i*h-n*u-a*s-o*c,t}function h(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=Math.sqrt(r*r+n*n+a*a),u=Math.exp(o),s=0<i?u*Math.sin(i)/i:0;return t[0]=r*s,t[1]=n*s,t[2]=a*s,t[3]=u*Math.cos(i),t}function l(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=Math.sqrt(r*r+n*n+a*a),u=0<i?Math.atan2(i,o)/i:0;return t[0]=r*u,t[1]=n*u,t[2]=a*u,t[3]=.5*Math.log(r*r+n*n+a*a+o*o),t}function f(t,e,r,n){var a,o,i,u,s,c=e[0],h=e[1],l=e[2],f=e[3],v=r[0],M=r[1],d=r[2],p=r[3];return(o=c*v+h*M+l*d+f*p)<0&&(o=-o,v=-v,M=-M,d=-d,p=-p),s=1-o>m.EPSILON?(a=Math.acos(o),i=Math.sin(a),u=Math.sin((1-n)*a)/i,Math.sin(n*a)/i):(u=1-n,n),t[0]=u*c+s*v,t[1]=u*h+s*M,t[2]=u*l+s*d,t[3]=u*f+s*p,t}function v(t,e){var r,n=e[0]+e[4]+e[8];if(0<n)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[3*a+a]&&(a=2);var o=(a+1)%3,i=(a+2)%3;r=Math.sqrt(e[3*a+a]-e[3*o+o]-e[3*i+i]+1),t[a]=.5*r,r=.5/r,t[3]=(e[3*o+i]-e[3*i+o])*r,t[o]=(e[3*o+a]+e[3*a+o])*r,t[i]=(e[3*i+a]+e[3*a+i])*r}return t}var M=o.clone;r.clone=M;var d=o.fromValues;r.fromValues=d;var p=o.copy;r.copy=p;var b=o.set;r.set=b;var y=o.add;r.add=y;var P=c;r.mul=P;var g=o.scale;r.scale=g;var O=o.dot;r.dot=O;var S=o.lerp;r.lerp=S;var A=o.length,D=r.length=A;r.len=D;var E=o.squaredLength,j=r.squaredLength=E;r.sqrLen=j;var w=o.normalize;r.normalize=w;var _=o.exactEquals;r.exactEquals=_;var R=o.equals;r.equals=R;var x,L,q,T=(x=a.create(),L=a.fromValues(1,0,0),q=a.fromValues(0,1,0),function(t,e,r){var n=a.dot(e,r);return n<-.999999?(a.cross(x,L,e),a.len(x)<1e-6&&a.cross(x,q,e),a.normalize(x,x),s(t,x,Math.PI),t):.999999<n?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(a.cross(x,e,r),t[0]=x[0],t[1]=x[1],t[2]=x[2],t[3]=1+n,w(t,t))});r.rotationTo=T;var I,Y,N=(I=u(),Y=u(),function(t,e,r,n,a,o){return f(I,e,a,o),f(Y,r,n,o),f(t,I,Y,2*o*(1-o)),t});r.sqlerp=N;var C,V=(C=n.create(),function(t,e,r,n){return C[0]=r[0],C[3]=r[1],C[6]=r[2],C[1]=n[0],C[4]=n[1],C[7]=n[2],C[2]=-e[0],C[5]=-e[1],C[8]=-e[2],w(t,v(t,C))});r.setAxes=V},{"./common.js":1,"./mat3.js":5,"./vec3.js":10,"./vec4.js":11}],8:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var t=new b.ARRAY_TYPE(8);b.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0);return t[3]=1,t},r.clone=function(t){var e=new b.ARRAY_TYPE(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e},r.fromValues=function(t,e,r,n,a,o,i,u){var s=new b.ARRAY_TYPE(8);return s[0]=t,s[1]=e,s[2]=r,s[3]=n,s[4]=a,s[5]=o,s[6]=i,s[7]=u,s},r.fromRotationTranslationValues=function(t,e,r,n,a,o,i){var u=new b.ARRAY_TYPE(8);u[0]=t,u[1]=e,u[2]=r,u[3]=n;var s=.5*a,c=.5*o,h=.5*i;return u[4]=s*n+c*r-h*e,u[5]=c*n+h*t-s*r,u[6]=h*n+s*e-c*t,u[7]=-s*t-c*e-h*r,u},r.fromRotationTranslation=o,r.fromTranslation=function(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t},r.fromRotation=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},r.fromMat4=function(t,e){var r=d.create();a.getRotation(r,e);var n=new b.ARRAY_TYPE(3);return a.getTranslation(n,e),o(t,r,n),t},r.copy=y,r.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},r.set=function(t,e,r,n,a,o,i,u,s){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t[4]=o,t[5]=i,t[6]=u,t[7]=s,t},r.getDual=function(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t},r.setDual=function(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t},r.getTranslation=function(t,e){var r=e[4],n=e[5],a=e[6],o=e[7],i=-e[0],u=-e[1],s=-e[2],c=e[3];return t[0]=2*(r*c+o*i+n*s-a*u),t[1]=2*(n*c+o*u+a*i-r*s),t[2]=2*(a*c+o*s+r*u-n*i),t},r.translate=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=.5*r[0],s=.5*r[1],c=.5*r[2],h=e[4],l=e[5],f=e[6],v=e[7];return t[0]=n,t[1]=a,t[2]=o,t[3]=i,t[4]=i*u+a*c-o*s+h,t[5]=i*s+o*u-n*c+l,t[6]=i*c+n*s-a*u+f,t[7]=-n*u-a*s-o*c+v,t},r.rotateX=function(t,e,r){var n=-e[0],a=-e[1],o=-e[2],i=e[3],u=e[4],s=e[5],c=e[6],h=e[7],l=u*i+h*n+s*o-c*a,f=s*i+h*a+c*n-u*o,v=c*i+h*o+u*a-s*n,M=h*i-u*n-s*a-c*o;return d.rotateX(t,e,r),n=t[0],a=t[1],o=t[2],i=t[3],t[4]=l*i+M*n+f*o-v*a,t[5]=f*i+M*a+v*n-l*o,t[6]=v*i+M*o+l*a-f*n,t[7]=M*i-l*n-f*a-v*o,t},r.rotateY=function(t,e,r){var n=-e[0],a=-e[1],o=-e[2],i=e[3],u=e[4],s=e[5],c=e[6],h=e[7],l=u*i+h*n+s*o-c*a,f=s*i+h*a+c*n-u*o,v=c*i+h*o+u*a-s*n,M=h*i-u*n-s*a-c*o;return d.rotateY(t,e,r),n=t[0],a=t[1],o=t[2],i=t[3],t[4]=l*i+M*n+f*o-v*a,t[5]=f*i+M*a+v*n-l*o,t[6]=v*i+M*o+l*a-f*n,t[7]=M*i-l*n-f*a-v*o,t},r.rotateZ=function(t,e,r){var n=-e[0],a=-e[1],o=-e[2],i=e[3],u=e[4],s=e[5],c=e[6],h=e[7],l=u*i+h*n+s*o-c*a,f=s*i+h*a+c*n-u*o,v=c*i+h*o+u*a-s*n,M=h*i-u*n-s*a-c*o;return d.rotateZ(t,e,r),n=t[0],a=t[1],o=t[2],i=t[3],t[4]=l*i+M*n+f*o-v*a,t[5]=f*i+M*a+v*n-l*o,t[6]=v*i+M*o+l*a-f*n,t[7]=M*i-l*n-f*a-v*o,t},r.rotateByQuatAppend=function(t,e,r){var n=r[0],a=r[1],o=r[2],i=r[3],u=e[0],s=e[1],c=e[2],h=e[3];return t[0]=u*i+h*n+s*o-c*a,t[1]=s*i+h*a+c*n-u*o,t[2]=c*i+h*o+u*a-s*n,t[3]=h*i-u*n-s*a-c*o,u=e[4],s=e[5],c=e[6],h=e[7],t[4]=u*i+h*n+s*o-c*a,t[5]=s*i+h*a+c*n-u*o,t[6]=c*i+h*o+u*a-s*n,t[7]=h*i-u*n-s*a-c*o,t},r.rotateByQuatPrepend=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=r[0],s=r[1],c=r[2],h=r[3];return t[0]=n*h+i*u+a*c-o*s,t[1]=a*h+i*s+o*u-n*c,t[2]=o*h+i*c+n*s-a*u,t[3]=i*h-n*u-a*s-o*c,u=r[4],s=r[5],c=r[6],h=r[7],t[4]=n*h+i*u+a*c-o*s,t[5]=a*h+i*s+o*u-n*c,t[6]=o*h+i*c+n*s-a*u,t[7]=i*h-n*u-a*s-o*c,t},r.rotateAroundAxis=function(t,e,r,n){if(Math.abs(n)<b.EPSILON)return y(t,e);var a=Math.hypot(r[0],r[1],r[2]);n*=.5;var o=Math.sin(n),i=o*r[0]/a,u=o*r[1]/a,s=o*r[2]/a,c=Math.cos(n),h=e[0],l=e[1],f=e[2],v=e[3];t[0]=h*c+v*i+l*s-f*u,t[1]=l*c+v*u+f*i-h*s,t[2]=f*c+v*s+h*u-l*i,t[3]=v*c-h*i-l*u-f*s;var M=e[4],d=e[5],p=e[6],m=e[7];return t[4]=M*c+m*i+d*s-p*u,t[5]=d*c+m*u+p*i-M*s,t[6]=p*c+m*s+M*u-d*i,t[7]=m*c-M*i-d*u-p*s,t},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t},r.multiply=s,r.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t},r.lerp=function(t,e,r,n){var a=1-n;h(e,r)<0&&(n=-n);return t[0]=e[0]*a+r[0]*n,t[1]=e[1]*a+r[1]*n,t[2]=e[2]*a+r[2]*n,t[3]=e[3]*a+r[3]*n,t[4]=e[4]*a+r[4]*n,t[5]=e[5]*a+r[5]*n,t[6]=e[6]*a+r[6]*n,t[7]=e[7]*a+r[7]*n,t},r.invert=function(t,e){var r=v(e);return t[0]=-e[0]/r,t[1]=-e[1]/r,t[2]=-e[2]/r,t[3]=e[3]/r,t[4]=-e[4]/r,t[5]=-e[5]/r,t[6]=-e[6]/r,t[7]=e[7]/r,t},r.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t},r.normalize=function(t,e){var r=v(e);if(0<r){r=Math.sqrt(r);var n=e[0]/r,a=e[1]/r,o=e[2]/r,i=e[3]/r,u=e[4],s=e[5],c=e[6],h=e[7],l=n*u+a*s+o*c+i*h;t[0]=n,t[1]=a,t[2]=o,t[3]=i,t[4]=(u-n*l)/r,t[5]=(s-a*l)/r,t[6]=(c-o*l)/r,t[7]=(h-i*l)/r}return t},r.str=function(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]},r.equals=function(t,e){var r=t[0],n=t[1],a=t[2],o=t[3],i=t[4],u=t[5],s=t[6],c=t[7],h=e[0],l=e[1],f=e[2],v=e[3],M=e[4],d=e[5],p=e[6],m=e[7];return Math.abs(r-h)<=b.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(n-l)<=b.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(a-f)<=b.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(o-v)<=b.EPSILON*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(i-M)<=b.EPSILON*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(u-d)<=b.EPSILON*Math.max(1,Math.abs(u),Math.abs(d))&&Math.abs(s-p)<=b.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(c-m)<=b.EPSILON*Math.max(1,Math.abs(c),Math.abs(m))},r.sqrLen=r.squaredLength=r.len=r.length=r.dot=r.mul=r.setReal=r.getReal=void 0;var b=n(t("./common.js")),d=n(t("./quat.js")),a=n(t("./mat4.js"));function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}function o(t,e,r){var n=.5*r[0],a=.5*r[1],o=.5*r[2],i=e[0],u=e[1],s=e[2],c=e[3];return t[0]=i,t[1]=u,t[2]=s,t[3]=c,t[4]=n*c+a*s-o*u,t[5]=a*c+o*i-n*s,t[6]=o*c+n*u-a*i,t[7]=-n*i-a*u-o*s,t}function y(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}var i=d.copy;r.getReal=i;var u=d.copy;function s(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3],u=r[4],s=r[5],c=r[6],h=r[7],l=e[4],f=e[5],v=e[6],M=e[7],d=r[0],p=r[1],m=r[2],b=r[3];return t[0]=n*b+i*d+a*m-o*p,t[1]=a*b+i*p+o*d-n*m,t[2]=o*b+i*m+n*p-a*d,t[3]=i*b-n*d-a*p-o*m,t[4]=n*h+i*u+a*c-o*s+l*b+M*d+f*m-v*p,t[5]=a*h+i*s+o*u-n*c+f*b+M*p+v*d-l*m,t[6]=o*h+i*c+n*s-a*u+v*b+M*m+l*p-f*d,t[7]=i*h-n*u-a*s-o*c+M*b-l*d-f*p-v*m,t}r.setReal=u;var c=s;r.mul=c;var h=d.dot;r.dot=h;var l=d.length,f=r.length=l;r.len=f;var v=d.squaredLength,M=r.squaredLength=v;r.sqrLen=M},{"./common.js":1,"./mat4.js":6,"./quat.js":7}],9:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.create=n,r.clone=function(t){var e=new i.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},r.fromValues=function(t,e){var r=new i.ARRAY_TYPE(2);return r[0]=t,r[1]=e,r},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},r.set=function(t,e,r){return t[0]=e,t[1]=r,t},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},r.subtract=a,r.multiply=o,r.divide=u,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},r.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},r.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},r.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},r.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t},r.distance=s,r.squaredDistance=c,r.length=h,r.squaredLength=l,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},r.normalize=function(t,e){var r=e[0],n=e[1],a=r*r+n*n;0<a&&(a=1/Math.sqrt(a));return t[0]=e[0]*a,t[1]=e[1]*a,t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},r.cross=function(t,e,r){var n=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=n,t},r.lerp=function(t,e,r,n){var a=e[0],o=e[1];return t[0]=a+n*(r[0]-a),t[1]=o+n*(r[1]-o),t},r.random=function(t,e){e=e||1;var r=2*i.RANDOM()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},r.transformMat2=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[2]*a,t[1]=r[1]*n+r[3]*a,t},r.transformMat2d=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[2]*a+r[4],t[1]=r[1]*n+r[3]*a+r[5],t},r.transformMat3=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[3]*a+r[6],t[1]=r[1]*n+r[4]*a+r[7],t},r.transformMat4=function(t,e,r){var n=e[0],a=e[1];return t[0]=r[0]*n+r[4]*a+r[12],t[1]=r[1]*n+r[5]*a+r[13],t},r.rotate=function(t,e,r,n){var a=e[0]-r[0],o=e[1]-r[1],i=Math.sin(n),u=Math.cos(n);return t[0]=a*u-o*i+r[0],t[1]=a*i+o*u+r[1],t},r.angle=function(t,e){var r=t[0],n=t[1],a=e[0],o=e[1],i=r*r+n*n;0<i&&(i=1/Math.sqrt(i));var u=a*a+o*o;0<u&&(u=1/Math.sqrt(u));var s=(r*a+n*o)*i*u;return 1<s?0:s<-1?Math.PI:Math.acos(s)},r.zero=function(t){return t[0]=0,t[1]=0,t},r.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},r.equals=function(t,e){var r=t[0],n=t[1],a=e[0],o=e[1];return Math.abs(r-a)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))},r.forEach=r.sqrLen=r.sqrDist=r.dist=r.div=r.mul=r.sub=r.len=void 0;var i=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}}(t("./common.js"));function n(){var t=new i.ARRAY_TYPE(2);return i.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0),t}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function o(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function u(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function s(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.hypot(r,n)}function c(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n}function h(t){var e=t[0],r=t[1];return Math.hypot(e,r)}function l(t){var e=t[0],r=t[1];return e*e+r*r}var f=h;r.len=f;var v=a;r.sub=v;var M=o;r.mul=M;var d=u;r.div=d;var p=s;r.dist=p;var m=c;r.sqrDist=m;var b=l;r.sqrLen=b;var y,P=(y=n(),function(t,e,r,n,a,o){var i,u;for(e=e||2,r=r||0,u=n?Math.min(n*e+r,t.length):t.length,i=r;i<u;i+=e)y[0]=t[i],y[1]=t[i+1],a(y,y,o),t[i]=y[0],t[i+1]=y[1];return t});r.forEach=P},{"./common.js":1}],10:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.create=n,r.clone=function(t){var e=new s.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},r.length=a,r.fromValues=o,r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},r.set=function(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},r.subtract=i,r.multiply=u,r.divide=c,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},r.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},r.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},r.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},r.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t},r.distance=h,r.squaredDistance=l,r.squaredLength=f,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},r.normalize=v,r.dot=M,r.cross=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=r[0],u=r[1],s=r[2];return t[0]=a*s-o*u,t[1]=o*i-n*s,t[2]=n*u-a*i,t},r.lerp=function(t,e,r,n){var a=e[0],o=e[1],i=e[2];return t[0]=a+n*(r[0]-a),t[1]=o+n*(r[1]-o),t[2]=i+n*(r[2]-i),t},r.hermite=function(t,e,r,n,a,o){var i=o*o,u=i*(2*o-3)+1,s=i*(o-2)+o,c=i*(o-1),h=i*(3-2*o);return t[0]=e[0]*u+r[0]*s+n[0]*c+a[0]*h,t[1]=e[1]*u+r[1]*s+n[1]*c+a[1]*h,t[2]=e[2]*u+r[2]*s+n[2]*c+a[2]*h,t},r.bezier=function(t,e,r,n,a,o){var i=1-o,u=i*i,s=o*o,c=u*i,h=3*o*u,l=3*s*i,f=s*o;return t[0]=e[0]*c+r[0]*h+n[0]*l+a[0]*f,t[1]=e[1]*c+r[1]*h+n[1]*l+a[1]*f,t[2]=e[2]*c+r[2]*h+n[2]*l+a[2]*f,t},r.random=function(t,e){e=e||1;var r=2*s.RANDOM()*Math.PI,n=2*s.RANDOM()-1,a=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*a,t[1]=Math.sin(r)*a,t[2]=n*e,t},r.transformMat4=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=r[3]*n+r[7]*a+r[11]*o+r[15];return i=i||1,t[0]=(r[0]*n+r[4]*a+r[8]*o+r[12])/i,t[1]=(r[1]*n+r[5]*a+r[9]*o+r[13])/i,t[2]=(r[2]*n+r[6]*a+r[10]*o+r[14])/i,t},r.transformMat3=function(t,e,r){var n=e[0],a=e[1],o=e[2];return t[0]=n*r[0]+a*r[3]+o*r[6],t[1]=n*r[1]+a*r[4]+o*r[7],t[2]=n*r[2]+a*r[5]+o*r[8],t},r.transformQuat=function(t,e,r){var n=r[0],a=r[1],o=r[2],i=r[3],u=e[0],s=e[1],c=e[2],h=a*c-o*s,l=o*u-n*c,f=n*s-a*u,v=a*f-o*l,M=o*h-n*f,d=n*l-a*h,p=2*i;return h*=p,l*=p,f*=p,v*=2,M*=2,d*=2,t[0]=u+h+v,t[1]=s+l+M,t[2]=c+f+d,t},r.rotateX=function(t,e,r,n){var a=[],o=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],o[0]=a[0],o[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n),o[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},r.rotateY=function(t,e,r,n){var a=[],o=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],o[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n),o[1]=a[1],o[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},r.rotateZ=function(t,e,r,n){var a=[],o=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],o[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n),o[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n),o[2]=a[2],t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},r.angle=function(t,e){var r=o(t[0],t[1],t[2]),n=o(e[0],e[1],e[2]);v(r,r),v(n,n);var a=M(r,n);return 1<a?0:a<-1?Math.PI:Math.acos(a)},r.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t},r.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},r.equals=function(t,e){var r=t[0],n=t[1],a=t[2],o=e[0],i=e[1],u=e[2];return Math.abs(r-o)<=s.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-i)<=s.EPSILON*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(a-u)<=s.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))},r.forEach=r.sqrLen=r.len=r.sqrDist=r.dist=r.div=r.mul=r.sub=void 0;var s=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}}(t("./common.js"));function n(){var t=new s.ARRAY_TYPE(3);return s.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function a(t){var e=t[0],r=t[1],n=t[2];return Math.hypot(e,r,n)}function o(t,e,r){var n=new s.ARRAY_TYPE(3);return n[0]=t,n[1]=e,n[2]=r,n}function i(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function u(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function c(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function h(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2];return Math.hypot(r,n,a)}function l(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2];return r*r+n*n+a*a}function f(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}function v(t,e){var r=e[0],n=e[1],a=e[2],o=r*r+n*n+a*a;return 0<o&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function M(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}var d=i;r.sub=d;var p=u;r.mul=p;var m=c;r.div=m;var b=h;r.dist=b;var y=l;r.sqrDist=y;var P=a;r.len=P;var g=f;r.sqrLen=g;var O,S=(O=n(),function(t,e,r,n,a,o){var i,u;for(e=e||3,r=r||0,u=n?Math.min(n*e+r,t.length):t.length,i=r;i<u;i+=e)O[0]=t[i],O[1]=t[i+1],O[2]=t[i+2],a(O,O,o),t[i]=O[0],t[i+1]=O[1],t[i+2]=O[2];return t});r.forEach=S},{"./common.js":1}],11:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.create=n,r.clone=function(t){var e=new h.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},r.fromValues=function(t,e,r,n){var a=new h.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=r,a[3]=n,a},r.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},r.set=function(t,e,r,n,a){return t[0]=e,t[1]=r,t[2]=n,t[3]=a,t},r.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},r.subtract=a,r.multiply=o,r.divide=i,r.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},r.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},r.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},r.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},r.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},r.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},r.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},r.distance=u,r.squaredDistance=s,r.length=c,r.squaredLength=l,r.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},r.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},r.normalize=function(t,e){var r=e[0],n=e[1],a=e[2],o=e[3],i=r*r+n*n+a*a+o*o;0<i&&(i=1/Math.sqrt(i));return t[0]=r*i,t[1]=n*i,t[2]=a*i,t[3]=o*i,t},r.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},r.cross=function(t,e,r,n){var a=r[0]*n[1]-r[1]*n[0],o=r[0]*n[2]-r[2]*n[0],i=r[0]*n[3]-r[3]*n[0],u=r[1]*n[2]-r[2]*n[1],s=r[1]*n[3]-r[3]*n[1],c=r[2]*n[3]-r[3]*n[2],h=e[0],l=e[1],f=e[2],v=e[3];return t[0]=l*c-f*s+v*u,t[1]=-h*c+f*i-v*o,t[2]=h*s-l*i+v*a,t[3]=-h*u+l*o-f*a,t},r.lerp=function(t,e,r,n){var a=e[0],o=e[1],i=e[2],u=e[3];return t[0]=a+n*(r[0]-a),t[1]=o+n*(r[1]-o),t[2]=i+n*(r[2]-i),t[3]=u+n*(r[3]-u),t},r.random=function(t,e){var r,n,a,o,i,u;e=e||1;for(;r=2*h.RANDOM()-1,n=2*h.RANDOM()-1,i=r*r+n*n,1<=i;);for(;a=2*h.RANDOM()-1,o=2*h.RANDOM()-1,u=a*a+o*o,1<=u;);var s=Math.sqrt((1-i)/u);return t[0]=e*r,t[1]=e*n,t[2]=e*a*s,t[3]=e*o*s,t},r.transformMat4=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=e[3];return t[0]=r[0]*n+r[4]*a+r[8]*o+r[12]*i,t[1]=r[1]*n+r[5]*a+r[9]*o+r[13]*i,t[2]=r[2]*n+r[6]*a+r[10]*o+r[14]*i,t[3]=r[3]*n+r[7]*a+r[11]*o+r[15]*i,t},r.transformQuat=function(t,e,r){var n=e[0],a=e[1],o=e[2],i=r[0],u=r[1],s=r[2],c=r[3],h=c*n+u*o-s*a,l=c*a+s*n-i*o,f=c*o+i*a-u*n,v=-i*n-u*a-s*o;return t[0]=h*c+v*-i+l*-s-f*-u,t[1]=l*c+v*-u+f*-i-h*-s,t[2]=f*c+v*-s+h*-u-l*-i,t[3]=e[3],t},r.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},r.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},r.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},r.equals=function(t,e){var r=t[0],n=t[1],a=t[2],o=t[3],i=e[0],u=e[1],s=e[2],c=e[3];return Math.abs(r-i)<=h.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-u)<=h.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(a-s)<=h.EPSILON*Math.max(1,Math.abs(a),Math.abs(s))&&Math.abs(o-c)<=h.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))},r.forEach=r.sqrLen=r.len=r.sqrDist=r.dist=r.div=r.mul=r.sub=void 0;var h=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}}(t("./common.js"));function n(){var t=new h.ARRAY_TYPE(4);return h.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function o(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function i(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function u(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],o=e[3]-t[3];return Math.hypot(r,n,a,o)}function s(t,e){var r=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],o=e[3]-t[3];return r*r+n*n+a*a+o*o}function c(t){var e=t[0],r=t[1],n=t[2],a=t[3];return Math.hypot(e,r,n,a)}function l(t){var e=t[0],r=t[1],n=t[2],a=t[3];return e*e+r*r+n*n+a*a}var f=a;r.sub=f;var v=o;r.mul=v;var M=i;r.div=M;var d=u;r.dist=d;var p=s;r.sqrDist=p;var m=c;r.len=m;var b=l;r.sqrLen=b;var y,P=(y=n(),function(t,e,r,n,a,o){var i,u;for(e=e||4,r=r||0,u=n?Math.min(n*e+r,t.length):t.length,i=r;i<u;i+=e)y[0]=t[i],y[1]=t[i+1],y[2]=t[i+2],y[3]=t[i+3],a(y,y,o),t[i]=y[0],t[i+1]=y[1],t[i+2]=y[2],t[i+3]=y[3];return t});r.forEach=P},{"./common.js":1}],12:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("./index"),a=t("./eventListener"),o=t("./connectedDevice"),i=a.EventListener.get(),u=(s.prototype.initMessageHandler=function(){this.airConsole.onMessage=function(t,e){if(e&&0===t){var r="SERVER_"+e.action;i.trigger(r,e.data)}}},s.prototype.onUpdateServerData=function(t){this.updateServerCallbacks.add(t)},s.prototype.updateServerData=function(){var e=this;this.updateServerCallbacks.forEach(function(t){return t(e.serverData)})},s.prototype.currentPlayerData=function(){var e=this;return console.table("currentPlayerData playerData",this.playerData),console.table("currentPlayerData id",this.id),this.playerData.filter(function(t){return t.id===e.id})[0]},s.prototype.sendControllerData=function(t){t.id=this.id,this.notifyServer(t)},s.prototype.subscribeToAirConsole=function(){var r=this;this.airConsole.onMessage=function(t,e){if(e)switch(e.transactionType){case n.TransactionType.PlayerData:console.log("received player data",e),r.playerData=e.playerData;break;case n.TransactionType.ObjectData:r.objectData=e.objectData;break;case n.TransactionType.ServerData:r.serverData=e.serverData,r.updateServerData();break;default:console.error("client onMessage switch",e)}else console.error("client onMessage",e)}},s.prototype.toggleAngryDad=function(){console.table("toggleAngryDad playerData",this.playerData),console.table("toggleAngryDad id",this.id);var t=this.currentPlayerData();return void 0===t.isAngryDad?t.isAngryDad=!1:t.isAngryDad=!t.isAngryDad,this.notifyServer(t),t.isAngryDad},s.prototype.changeAppearance=function(t){var e=this.currentPlayerData();return e.characterAppearanceType=t,this.notifyServer(e),e.characterAppearanceType},s.prototype.interacting=function(t){var e=this.currentPlayerData();return e.playerState=t,this.notifyServer(e),e.playerState},s.prototype.notifyServer=function(t){this.airConsole.message(AirConsole.SCREEN,t)},s.prototype.getTime=function(){return this.serverData.timerValueInSeconds},s);function s(){var e=this;this.id=0,this.playerData=[],this.objectData=[],this.updateServerCallbacks=new Set,this.serverData=new n.ServerData(30,n.ServerState.initial),this.awaitReady=new Promise(function(t){e.airConsole=new AirConsole,e.initMessageHandler(),e.airConsole.onDeviceStateChange=function(e,r){try{o.getDevice(e).updateState(r)}catch(t){new o.ConnectedDevice(e).updateState(r)}},i.on("SERVER_updateState",function(t){console.log("game state changed",t.state),t.state,"choose"===t.state&&e.airConsole.setCustomDeviceState({wantAngry:.5<Math.random()}),t.state})})}r.Client=u},{"./connectedDevice":13,"./eventListener":14,"./index":15}],13:[function(t,e,r){"use strict";var n=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),a=0;for(e=0;e<r;e++)for(var o=arguments[e],i=0,u=o.length;i<u;i++,a++)n[a]=o[i];return n};Object.defineProperty(r,"__esModule",{value:!0});var a=t("./eventListener").EventListener.get(),o=new Map;r.getDevice=function(t){if(!o.has(t))throw new Error("The device does not exist: "+t);return o.get(t)},r.getAllDevices=function(){return n(o.values())};var i=0,u=(s.prototype.disconnect=function(){o.delete(this.deviceId),a.trigger("deviceDisconnected",this)},s.prototype.updateState=function(t){this.stateData=t},s.prototype.updateCustomState=function(t){this.customStateData=t},s.prototype.toJson=function(){return{internalID:this.internalID,deviceId:this.deviceId}},s);function s(t){this.deviceId=t,this.internalID=i++,o.set(t,this),a.trigger("deviceJoined",this)}r.ConnectedDevice=u},{"./eventListener":14}],14:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=(a.get=function(){return void 0===this.instance&&(this.instance=new a),this.instance},a.prototype.on=function(t,e){return void 0===this.listener[t]&&(this.listener[t]=[]),this.listener[t].push(e),e},a.prototype.off=function(t,e){if(void 0!==this.listener[t]){var r=this.listener[t].indexOf(e);-1!==r&&this.listener[t].splice(r,1)}return e},a.prototype.trigger=function(t,e){void 0!==this.listener[t]&&this.listener[t].forEach(function(t){return t(e)})},a);function a(){this.listener={}}r.EventListener=n},{}],15:[function(t,e,r){"use strict";function n(t){for(var e in t)r.hasOwnProperty(e)||(r[e]=t[e])}Object.defineProperty(r,"__esModule",{value:!0});var a=t("gl-matrix");n(t("./client")),n(t("./server"));function o(t,e,r){this.x=t,this.y=e,this.id=r,this.transactionType=i.PlayerData,this.playerState=l.idle,this.isAngryDad=!1,this.characterAppearanceType=v.wichtel1}var i,u,s;a.vec2.fromValues(23,-55);r.PlayerData=o,(u=i=r.TransactionType||(r.TransactionType={}))[u.ServerData=0]="ServerData",u[u.PlayerData=1]="PlayerData",u[u.ControllerData=2]="ControllerData",u[u.ObjectData=3]="ObjectData",(s=r.ServerState||(r.ServerState={}))[s.initial=0]="initial",s[s.lobby=1]="lobby",s[s.characterSelection=2]="characterSelection",s[s.running=3]="running",s[s.final=4]="final";function c(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e,this.id=0,this.transactionType=i.ControllerData}r.ControllerData=c;function h(t,e){void 0===t&&(t=30),this.timerValueInSeconds=t,this.serverState=e}var l,f,v,M;r.ServerData=h,(f=l=r.PlayerState||(r.PlayerState={}))[f.idle=0]="idle",f[f.dead=1]="dead",f[f.running=2]="running",f[f.interacting=3]="interacting",(M=v=r.CharacterAppearanceType||(r.CharacterAppearanceType={}))[M.wichtel1=0]="wichtel1",M[M.wichtel2=1]="wichtel2",M[M.wichtel3=2]="wichtel3",M[M.wichtel4=3]="wichtel4";function d(t,e,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),this.x=t,this.y=e,this.damage=r,this.objectId=n}r.ObjectData=d},{"./client":12,"./server":16,"gl-matrix":2}],16:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("./index"),a=t("./connectedDevice"),o=t("./eventListener"),i=t("./server/gameStateJoin"),u=o.EventListener.get();r.OBJECTDATAMAXHEALTH=10;var s=(c.prototype.initTick=function(){var r=this,n=performance.now();setInterval(function(){var t=performance.now(),e=t-n;n=t,r.gameState.tick(e)},1e3/60)},c.prototype.initMessageHandler=function(){this.airConsole.onMessage=function(t,e){if(e&&0===t){var r="CLIENT_"+e.action;e.data.from=t,u.trigger(r,e.data)}}},c.prototype.subscribeToAirConsole=function(){this.airConsole.onConnect=function(t){},this.airConsole.onDisconnect=function(t){a.getDevice(t).disconnect()},this.airConsole.onDeviceStateChange=function(e,r){try{a.getDevice(e).updateState(r)}catch(t){new a.ConnectedDevice(e).updateState(r)}},this.airConsole.onCustomDeviceStateChange=function(e,r){try{a.getDevice(e).updateCustomState(r)}catch(t){new a.ConnectedDevice(e).updateCustomState(r)}}},c);function c(){var e=this;this.playerData=[],this.objectData=[],this.airConsole=new AirConsole,this.serverData=new n.ServerData(30,n.ServerState.initial),this.subscribeToAirConsole(),this.gameState=new i.GameStateJoin(this,3e3),u.on("newGameState",function(t){e.gameState=t}),this.initTick(),this.initMessageHandler()}r.Server=s},{"./connectedDevice":13,"./eventListener":14,"./index":15,"./server/gameStateJoin":19}],17:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("../eventListener").EventListener.get(),a=(o.prototype.tick=function(t){},o.prototype.enter=function(){},o.prototype.exit=function(){var t=new this.nextState(this.server);n.trigger("newGameState",t)},o.prototype.onExit=function(t){this.callback=t},o);function o(t){this.server=t,this.enter()}r.GameState=a},{"../eventListener":14}],18:[function(t,e,r){"use strict";var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var o,i=t("./gameState"),u=t("../eventListener"),s=t("../connectedDevice"),c=(u.EventListener.get(),o=i.GameState,a(h,o),h.prototype.enter=function(){this.startTimer(),this.server.airConsole.broadcast({action:"updateState",data:{state:"choose",timerStarted:this.timerStarted,duration:3e3}})},h.prototype.tick=function(t){void 0!==this.timerStarted&&this.duration-(Date.now()-this.timerStarted)<=0&&(console.log("timer is up, next state"),this.exit())},h.prototype.exit=function(){var t=void 0,e=s.getAllDevices(),r=e.filter(function(t){return t.customStateData.wantAngry});t=0===r.length?e[Math.floor(e.length*Math.random())]:r[Math.floor(r.length*Math.random())],console.log("and the winner is:",t,e,r),s.getAllDevices().forEach(function(t){console.log(t.customStateData)}),o.prototype.exit.call(this)},h.prototype.startTimer=function(){console.log("player joined, starting timer"),this.timerStarted=Date.now()},h);function h(t){var e=o.call(this,t)||this;return e.duration=3e3,e.nextState=i.GameState,e}r.GameStateChoose=c},{"../connectedDevice":13,"../eventListener":14,"./gameState":17}],19:[function(t,e,r){"use strict";var n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var o,i=t("./gameState"),u=t("../eventListener"),s=t("./gameStateChoose"),c=u.EventListener.get(),h=(o=i.GameState,a(l,o),l.prototype.tick=function(t){void 0!==this.timerStarted&&this.duration-(Date.now()-this.timerStarted)<=0&&(console.log("timer is up, next state"),this.exit())},l.prototype.enter=function(){var e=this;this.deviceJoinedCallback=c.on("deviceJoined",function(t){e.timerStarted||e.startTimer(),e.server.airConsole.message(t.deviceId,{action:"updateState",data:{state:"join",timerStarted:e.timerStarted,duration:e.duration}})})},l.prototype.exit=function(){c.off("deviceJoined",this.deviceJoinedCallback),this.server.airConsole.setActivePlayers(4),o.prototype.exit.call(this)},l.prototype.startTimer=function(){console.log("player joined, starting timer"),this.timerStarted=Date.now()},l);function l(t,e){var r=o.call(this,t)||this;return r.duration=e,r.nextState=s.GameStateChoose,r}r.GameStateJoin=h},{"../eventListener":14,"./gameState":17,"./gameStateChoose":18}],20:[function(t,e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a,n,o=t("../common/index");(n=a=r.Views||(r.Views={}))[n.splashscreen=0]="splashscreen",n[n.characterselection=1]="characterselection",n[n.playscreen=2]="playscreen",n[n.endscreen=3]="endscreen";var i=(u.prototype.showView=function(t){document.querySelectorAll(a[t])[0].classList.add("visible")},u.prototype.hideView=function(t){document.querySelectorAll(a[t])[0].classList.remove("visible")},u.prototype.updateView=function(t){switch(console.log("new server state received",o.ServerState[t.serverState]),t.serverState){case o.ServerState.lobby:this.showView(a.splashscreen),this.lobby();break;case o.ServerState.characterSelection:this.showView(a.characterselection),this.characterselection();break;case o.ServerState.running:this.showView(a.playscreen),this.virtualController();break;case o.ServerState.final:this.showView(a.endscreen);break;default:console.error("not implemented",t)}},u.prototype.virtualController=function(){var e=this;document.querySelectorAll("playscreen > controller")[0].addEventListener("touchstart",function(t){e.startPos=[t.targetTouches[0].clientX,t.targetTouches[0].clientY]}),document.querySelectorAll("playscreen > controller")[0].addEventListener("touchmove",function(t){void 0!==e.startPos&&e.client.sendControllerData(new o.ControllerData(t.targetTouches[0].clientX-e.startPos[0],t.targetTouches[0].clientY-e.startPos[1]))}),document.querySelectorAll("playscreen > controller")[0].addEventListener("touchend",function(t){e.startPos=void 0})},u.prototype.lobby=function(){this.setTime(a.splashscreen)},u.prototype.characterselection=function(){var e=this;document.querySelectorAll("characterselection > button").forEach(function(t){e.client.toggleAngryDad()?(document.querySelectorAll("characterselection")[0].classList.add("isAngryDad"),console.log("You would like to be angry dad!")):(document.querySelectorAll("characterselection")[0].classList.remove("isAngryDad"),console.log("You would like to be a wichtel!"))}),this.setTime(a.characterselection)},u.prototype.setTime=function(e){var r=this,n=setInterval(function(){var t=r.client.getTime();document.querySelectorAll(a[e]+" > time")[0].innerHTML=t.toString(),0===t&&clearInterval(n)},1e3)},u);function u(t){this.client=t,this.startPos=void 0,this.client.onUpdateServerData(this.updateView.bind(this))}document.addEventListener("DOMContentLoaded",function(){var t=new o.Client;new i(t)})},{"../common/index":15}]},{},[20]);
>>>>>>> Stashed changes
//# sourceMappingURL=index.min.js.map
